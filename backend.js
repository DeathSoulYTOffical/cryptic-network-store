const _0x4df485=_0x5430;(function(_0x4224ab,_0x177da3){const _0x46ed75=_0x5430,_0x2ca9c1=_0x4224ab();while(!![]){try{const _0xb6f42c=-parseInt(_0x46ed75(0x242))/0x1+-parseInt(_0x46ed75(0x21b))/0x2+-parseInt(_0x46ed75(0x2d5))/0x3*(parseInt(_0x46ed75(0x20a))/0x4)+-parseInt(_0x46ed75(0x1e8))/0x5+parseInt(_0x46ed75(0x31e))/0x6*(-parseInt(_0x46ed75(0x22a))/0x7)+-parseInt(_0x46ed75(0x358))/0x8+-parseInt(_0x46ed75(0x2f6))/0x9*(-parseInt(_0x46ed75(0x294))/0xa);if(_0xb6f42c===_0x177da3)break;else _0x2ca9c1['push'](_0x2ca9c1['shift']());}catch(_0x17503c){_0x2ca9c1['push'](_0x2ca9c1['shift']());}}}(_0x4f4b,0xec4fb));const config=require(_0x4df485(0x369)),passport=require(_0x4df485(0x324)),multer=require(_0x4df485(0x1fd)),bodyParser=require(_0x4df485(0x33f)),session=require(_0x4df485(0x2f7)),express=require(_0x4df485(0x2a8)),figlet=require('figlet'),chalk=require('chalk'),axios=require(_0x4df485(0x304)),ms=require('ms'),fs=require(_0x4df485(0x2e3)),path=require(_0x4df485(0x23d)),requestIp=require(_0x4df485(0x1ac)),firewallgg=require(_0x4df485(0x1a9)),PaypalImport=require(_0x4df485(0x33d)),Stripe=require(_0x4df485(0x1cf));let stripe,paypalClient;if(config['paymentSettings']['usePaypal']){let liveEnv=new PaypalImport[(_0x4df485(0x328))][(_0x4df485(0x323))](config['paymentSettings'][_0x4df485(0x269)],config[_0x4df485(0x2b2)][_0x4df485(0x2ae)]);paypalClient=new PaypalImport[(_0x4df485(0x328))]['PayPalHttpClient'](liveEnv);}config[_0x4df485(0x2b2)][_0x4df485(0x2f3)]&&(stripe=new Stripe(config[_0x4df485(0x2b2)][_0x4df485(0x2f2)],{'timeout':0x4e20,'maxNetworkRetries':0x2}));const nodemailer=require(_0x4df485(0x35d));let transporter=null;config?.['emails']?.[_0x4df485(0x1bd)]&&(transporter=nodemailer['createTransport'](config['emails'][_0x4df485(0x1d3)]));const {Client}=require('discord.js');class HDClient extends Client{constructor(_0xb1719f={}){const _0x2471fc=_0x4df485;super(_0xb1719f),this[_0x2471fc(0x21d)]=config,this['discord']=require(_0x2471fc(0x1da));}}const client=new HDClient({'intents':['GUILDS',_0x4df485(0x293),_0x4df485(0x32d),_0x4df485(0x275),_0x4df485(0x306),_0x4df485(0x23c),_0x4df485(0x209),_0x4df485(0x32f),'GUILD_INVITES','GUILD_VOICE_STATES',_0x4df485(0x345),_0x4df485(0x374),'DIRECT_MESSAGE_REACTIONS',_0x4df485(0x19d)],'partials':['MESSAGE','CHANNEL',_0x4df485(0x2df),_0x4df485(0x1ae),_0x4df485(0x351),_0x4df485(0x20b),_0x4df485(0x21a),_0x4df485(0x354)],'allowedMentions':{'parse':[_0x4df485(0x2d7),_0x4df485(0x1a4),_0x4df485(0x2c9)],'repliedUser':!![]}}),pjson=require(_0x4df485(0x1fe)),utils=require('hyperz-utils');let dbcon,storedAppVariable,d;config[_0x4df485(0x29c)][_0x4df485(0x33b)]('/')?d=config[_0x4df485(0x29c)]:d=config[_0x4df485(0x29c)]+'/';process['on'](_0x4df485(0x301),_0x42717c=>{const _0x2f3ad1=_0x4df485;if(_0x42717c[_0x2f3ad1(0x371)]()['replaceAll']('\x20','')[_0x2f3ad1(0x261)](_0x2f3ad1(0x31b)))return;config[_0x2f3ad1(0x34b)]&&console[_0x2f3ad1(0x2a0)](chalk[_0x2f3ad1(0x2d0)](_0x42717c));});async function init(_0x48c014,_0x4fba83){const _0x414556=_0x4df485;Number(process[_0x414556(0x246)][_0x414556(0x229)](0x1)[_0x414556(0x204)]('.')[0x0]<0x10)&&console['log'](_0x414556(0x24b));var _0x39a721=multer[_0x414556(0x34d)]();_0x48c014[_0x414556(0x1e5)](multer({'storage':_0x39a721})[_0x414556(0x277)]()),_0x48c014[_0x414556(0x1e5)](bodyParser[_0x414556(0x1ec)]({'extended':![]})),_0x48c014[_0x414556(0x1e5)](express[_0x414556(0x1ed)]()),_0x48c014[_0x414556(0x1e5)](session({'secret':_0x414556(0x254),'resave':![],'saveUninitialized':![],'cookie':{'maxAge':0x758f0dfc0}})),_0x48c014['use'](passport['initialize']()),_0x48c014[_0x414556(0x1e5)](passport['session']()),_0x48c014[_0x414556(0x315)](_0x414556(0x1b0),'./src/views'),_0x48c014[_0x414556(0x315)](_0x414556(0x29e),'ejs'),_0x48c014[_0x414556(0x1e5)](express[_0x414556(0x24e)]('public')),_0x48c014['use'](express[_0x414556(0x24e)]('src/static')),_0x48c014[_0x414556(0x1e5)](_0x414556(0x34f),express['static'](__dirname+_0x414556(0x19e))),_0x48c014[_0x414556(0x1e5)](_0x414556(0x243),express[_0x414556(0x24e)](__dirname+_0x414556(0x35e))),_0x48c014[_0x414556(0x1e5)](requestIp['mw']()),dbcon=_0x4fba83;let _0x5693ba=await utils['getRandomArray']([_0x414556(0x256)]);figlet['text']('Payment\x20System',{'font':_0x5693ba,'width':0x2bc},function(_0x546d98,_0x32342c){const _0x49dad3=_0x414556;if(_0x546d98)throw _0x546d98;let _0x2783d8=_0x32342c+'\x0aCracked\x20By\x20Advanced\x20Leaks';console[_0x49dad3(0x2a0)](chalk['bold'](chalk[_0x49dad3(0x2c6)](_0x2783d8)));}),await resetAppLocals(_0x48c014),sqlLoop(_0x4fba83),markSqlConnected(),setInterval(async function(){resetAppLocals(_0x48c014);},ms('24h')),initDiscordBot(),setTimeout(async function(){const _0x14d108=_0x414556,_0x294023=await fs[_0x14d108(0x205)](path[_0x14d108(0x2e9)](__dirname,'./','extensions'));await _0x294023[_0x14d108(0x32a)](async function(_0x122347){const _0x162794=_0x14d108;let _0x5cf6cf=path[_0x162794(0x2e9)](__dirname,'./',_0x162794(0x2b7)+_0x122347);_0x122347=fs[_0x162794(0x205)](_0x5cf6cf);if(_0x122347[_0x162794(0x261)](_0x162794(0x2d1))){let _0x5a189b=require(_0x5cf6cf+_0x162794(0x2bd));console[_0x162794(0x2a0)](chalk['cyanBright'](_0x162794(0x2ef))+'\x20'+_0x5a189b?.[_0x162794(0x221)]+'\x20('+_0x5a189b?.['version']+_0x162794(0x2a4)),fs[_0x162794(0x2ee)](_0x5cf6cf+('/'+_0x5a189b?.[_0x162794(0x239)]))?require(_0x162794(0x21f)+_0x122347+'/'+_0x5a189b?.['file'])(client,_0x4fba83,_0x48c014):console['log'](chalk[_0x162794(0x289)](_0x162794(0x2ef))+'\x20'+chalk[_0x162794(0x248)](_0x162794(0x311))+'\x20'+_0x122347+_0x162794(0x2de));}else console[_0x162794(0x2a0)](chalk['cyanBright'](_0x162794(0x2ef))+'\x20'+chalk['yellowBright'](_0x162794(0x311))+'\x20'+_0x122347+_0x162794(0x234));});if(typeof extensions==_0x14d108(0x362))return;for(let _0x2bdfed of extensions){const _0xab4835=_0x2bdfed[_0x14d108(0x204)]('.')[0x0];console[_0x14d108(0x2a0)](chalk['cyanBright']('[Extension\x20Manager]')+'\x20'+_0x2bdfed['split']('.')[0x0]+'\x20-\x20Loaded'),require('./extensions/'+_0x2bdfed)(client,_0x4fba83,_0x48c014);}},0x5dc);}function _0x4f4b(){const _0x23fe8f=['setThumbnail','sourceFile','render','PayPal\x20payment\x20error\x20(E03).','SELECT\x20*\x20FROM\x20receipts','!\x0a\x0aWe\x20are\x20contacting\x20you\x20to\x20inform\x20you\x20that\x20your\x20checkout\x20has\x20been\x20completed\x20successfully!\x20If\x20you\x20have\x20any\x20questions\x20please\x20do\x20not\x20hesitate\x20to\x20ask!\x0a<p\x20style=\x27font-weight:\x20600;\x27>Receipt\x20Items:</p>',')\x20completed\x20their\x20checkout\x20session.','MessageButton','SELECT\x20*\x20FROM\x20users\x20WHERE\x20userid=\x22','faxdomain','avatar','GUILD_INVITES','1765060wTPVId','Invoice\x20#','config','length','./extensions/','push','name','via\x20','That\x20user\x20does\x20not\x20have\x20an\x20account\x20on\x20',')\x20is\x20banned\x20on\x20[FirewallGG](https://firewall.hyperz.net)\x20in\x20',')\x20has\x20created\x20a\x20checkout\x20session\x20for\x20their\x20Giftcard.','requestBody','editReply','SELECT\x20*\x20FROM\x20users\x20WHERE\x20email=\x22','slice','693nubYcQ','UPDATE\x20products\x20SET\x20overallprofit=\x22','/404','none','status','PayPal\x20payment\x20error\x20(E02).','timeZone','stars','/paypal','/backend/finishcheckoutinvoice/','\x20-\x20Missing\x20data\x20file.','SELECT\x20*\x20FROM\x20advertisements','/tos','\x22,\x20\x22','product_','file','INSERT\x20INTO\x20receipts\x20(uniqueid,\x20buyerid,\x20items,\x20payment,\x20datetime)\x20VALUES\x20(\x27','fetch','GUILD_BANS','path','<br>','/backend/finishcheckout/','\x27,\x20\x27PayPal\x27,\x20\x27','setDescription','814383GTFbSm','/static','Checkout\x20Session\x20Created\x20-\x20Giftcard','add','version','options','yellowBright','itemType','/invoice/','Node.js\x20v16\x20or\x20higher\x20is\x20required,\x20Discord.JS\x20relies\x20on\x20this\x20version,\x20please\x20update\x20@\x20https://nodejs.org','`\x0a**○\x20Description:**\x20','username','static','INSERT\x20INTO\x20custompages\x20(uniqueid,\x20title,\x20link,\x20content)\x20VALUES\x20(\x22','channels','SELECT\x20*\x20FROM\x20ownedgiftcards\x20WHERE\x20code=\x22','toUpperCase','floor','keyboard\x20cat','discordRole','Standard','Owner\x20Added\x20As\x20Staff','Checkout\x20Completed','WATCHING','userId','emails','ready','\x27,\x20\x27PayPal\x27)','catch','faxstoreid','INSERT\x20INTO\x20products\x20(uniqueid,\x20name,\x20link,\x20description,\x20credits,\x20price,\x20gallery,\x20pos,\x20zipfilename,\x20givenrole)\x20VALUES\x20(\x22','includes','INSERT\x20INTO\x20pendingpurchases\x20(uniqueid,\x20userid,\x20sessionid,\x20paymenttype,\x20leftover)\x20VALUES\x20(\x27','[@Hyperz](https://hyperz.net)\x20-\x20*Writing\x20all\x20of\x20the\x20code.*\x0a[@Xolify](https://xolify.store)\x20-\x20*Helping\x20navigate\x20Stripe\x20docs\x20lol.*','.49','INSERT\x20INTO\x20notifications\x20(uniqueid,\x20userid,\x20content,\x20datetime,\x20hasbeenread)\x20VALUES\x20(\x22','guilds','/giftcards','sqlhost','paypalClientId','MessageActionRow','sendMail','DELETE\x20FROM\x20ownedgiftcards\x20WHERE\x20code=\x22','Checkout\x20Complete!','\x20databases.','SELECT\x20*\x20FROM\x20giftcards\x20WHERE\x20uniqueid=\x22','UPDATE\x20users\x20SET\x20cart=\x22[]\x22,\x20client=true,\x20discount=0,\x20giftcard=\x27none\x27\x20WHERE\x20userid=\x22','fetchTime','🚫\x20HypeBans\x20-\x20User\x20Added','avatar_','sitesettings','DIRECT_MESSAGES','https://discord.com/api/v10/guilds/','any','INSERT\x20INTO\x20discounts\x20(uniqueid,\x20code,\x20percent)\x20VALUES\x20(\x22','title','Giftcard\x20Checkout\x20Completed','🚫\x20FirewallGG\x20-\x20User\x20Added','ownerIds','SELECT\x20*\x20FROM\x20navbar','checkIfHex','isCommand','\x22,\x20false)','toFixed','link','Add\x20or\x20remove\x20admins\x20from\x20the\x20site.','rar','https://discord.com/api/oauth2/authorize?client_id=','\x22,\x20guildid=\x22','discordGuildId','orders','cyanBright','/banned','\x27,\x20','https://bans.hyperz.net/api/checkuser/','INSERT\x20INTO\x20owneditems\x20(uniqueid,\x20productid,\x20userid,\x20productname,\x20datebought,\x20price,\x20receipt,\x20licensekey,\x20disabled,\x20admindisabled,\x20downloads)\x20VALUES\x20(\x22','/paypal/','client','/stripe','.png','clientIp','GUILD_MESSAGES','430rcSsZq','guildid','givenrole','getString','INSERT\x20INTO\x20users\x20(giftcard,\x20userid,\x20email,\x20username,\x20latestip,\x20cart,\x20discount,\x20note,\x20client,\x20mailinglist,\x20mailendpoints)\x20VALUES\x20(\x27none\x27,\x20\x27','query','reverse','/assets/logo.png','domain','No\x20results\x20found\x20for\x20`','view\x20engine','\x22\x20LIMIT\x201','log','account','sqldatabase','customId',')\x20-\x20Loaded','create','[SQL\x20Manager]','/backend/finishcheckoutgiftcard/','express','productId','uniqueid','/account\x27>here</a>!','format','sessionid','paypalClientSecret','createdAt','productName','login','paymentSettings','INSERT\x20INTO\x20invoices\x20(uniqueid,\x20userid,\x20title,\x20description,\x20price,\x20paid,\x20datetime)\x20VALUES\x20(\x22','SELECT\x20*\x20FROM\x20bannedusers\x20WHERE\x20userid=\x22','OrdersCaptureRequest','send','extensions/','string',')\x20created\x20an\x20account.','No\x20uniqueid\x20in\x20cart\x20completion\x20ticket\x20after\x20payment.','sitecolor','payment','/extension.json','SELECT\x20*\x20FROM\x20pendingpurchases\x20WHERE\x20uniqueid=\x22','No\x20reason\x20could\x20be\x20found...','setPresence','LINK','green','reason','active','parse','blueBright','\x27,\x20\x27NO_VALUE_100_DISCOUNT\x27,\x20\x27PayPal\x27)','description','everyone','\x22,\x20termsofservice=\x22','rel','./public/images','totalincome','currency','MessageEmbed','red','extension.json','\x27,\x20\x27[]\x27,\x200,\x20\x27','giftcardid','has','402GlReJN','Hey\x20there,\x20we\x20are\x20happy\x20to\x20see\x20you\x20joining\x20our\x20community!\x20If\x20you\x20have\x20any\x20questions\x20don\x27t\x20hesitate\x20to\x20ask.\x0a\x0aWe\x20value\x20all\x20of\x20our\x20members,\x20clients,\x20staff,\x20and\x20work!\x20You\x20are\x20our\x20priority\x20and\x20we\x20strive\x20to\x20provide\x20the\x20greatest\x20support\x20we\x20can!\x0a\x0a<a\x20href=\x27','users','The\x20term\x20to\x20search\x20for\x20a\x20product.','.00','locals','/auth/discord','SELECT\x20*\x20FROM\x20users','\x0a**○\x20Price:**\x20`','\x20-\x20Missing\x20executable\x20file.','REACTION','giftcard',')\x20has\x20created\x20a\x20checkout\x20session.','\x27,\x20\x27NO_VALUE_100_DISCOUNT\x27,\x20\x27PayPal\x27,\x20\x27','node:fs','stack','INSERT\x20INTO\x20bannedusers\x20(userid)\x20VALUES\x20(\x22','\x20TOS\x20-\x20','\x22\x20WHERE\x20uniqueid=\x22','<p><b>Invalid\x20MySQL\x20Information\x20Provided\x20/\x20Connection\x20Failed...</b></p><p\x20style=\x22color:\x20red;\x22>Process\x20Cancelled.</p><a\x20href=\x22/admin/integration\x22>Return\x20back</a>','join','replaceAll','SHOW\x20TABLES;','\x27,\x20\x27NO_VALUE_100_DISCOUNT\x27,\x20\x27Stripe\x27,\x20\x27','now','existsSync','[Extension\x20Manager]','userEmail','paymenttype','stripeSecretKey','useStripe','\x22,\x20homeabout=\x22','discord','1489167CgJFkW','express-session','SELECT\x20*\x20FROM\x20invoices\x20WHERE\x20paid=true','term','SELECT\x20*\x20FROM\x20sitesettings','/account\x27\x20style=\x22color:\x20white;\x20text-decoration:\x20none;\x20padding:\x200.6em;\x20font-size:\x201.4em;\x20border-radius:\x200.4em;\x20background-color:\x20','sitename','roleids','\x27,\x20\x27NO_VALUE_100_DISCOUNT_INVOICE\x27,\x20\x27Stripe\x27)',')\x20is\x20banned\x20on\x20the\x20ban\x20database.','UPDATE\x20ownedgiftcards\x20SET\x20amount=\x22','unhandledRejection','Account\x20Id:\x20','\x0a\x0a\x0aYou\x20can\x20view\x20your\x20account\x20and\x20retrieve\x20your\x20items\x20below!\x0a\x0a<a\x20href=\x27','axios','/shop/','GUILD_MEMBERS','sqlusername','\x20MySQL\x20successfully\x20connected.','staffnotes','\x27s\x20Account','checkout','cache','filter','SELECT\x20*\x20FROM\x20users\x20WHERE\x20userid=\x27','INSERT\x20INTO\x20auditlogs\x20(userId,\x20action,\x20details,\x20createdAt)\x20VALUES\x20(\x22','[View\x20Profile](','FAILED:','\x27,\x20\x27Stripe\x27)','\x27,\x20\x27Stripe\x27,\x20\x27','PayPal\x20payment\x20error.\x20Declined\x20(E04)','set','white','/account/','\x20Account:\x20','A\x20description\x20/\x20details\x20about\x20this\x20invoice.','A\x20simple\x20ping\x20command.','cachedDataRejected','generateRandom','members','87102xWLbrX','sessions','approve','result','\x22,\x20false,\x20false,\x200)','LiveEnvironment','passport','content','importHyperzBans','statusCode','core','\x22,\x20\x22faxstore\x22,\x20\x22','forEach','url','redirect','GUILD_MESSAGE_REACTIONS','saveFile','GUILD_WEBHOOKS','href','stringify','type','migration.ejs','OrdersCreateRequest','/shop','#FFFFFF','\x20TOS:\x20','User\x20','\x22,\x20sitecolor=\x22','./public/assets','endsWith','exports','@paypal/checkout-server-sdk','INSERT\x20INTO\x20ownedgiftcards\x20(uniqueid,\x20giftcardid,\x20code,\x20amount,\x20purchaserid)\x20VALUES\x20(\x22','body-parser','random','user','SELECT\x20*\x20FROM\x20owneditems\x20WHERE\x20userid=\x22','writeFileSync','&permissions=8&scope=bot%20applications.commands','GUILD_PRESENCES','NOTIFICATIONS','0.00','PUT','invoiceid','price','debugMode',')\x20has\x20started\x20FaxStore\x20Migration!','memoryStorage','discriminator','/assets','audit','GUILD_MEMBER','position',',\x201,\x20\x27[\x22NOTIFICATIONS\x22,\x20\x22LOGIN_SESSION\x22]\x27)','MANAGE_GUILD','FaxStore\x20Migration\x20-\x20Started',')\x20completed\x20their\x20checkout\x20session\x20for\x20their\x20invoice.','sign','5683448UHKali','**Invoice\x20generated!**','UPDATE\x20sitesettings\x20SET\x20totalincome=\x22','leftover','[INVITE]','nodemailer','src/static/assets','guild','No\x20type\x20in\x20request\x20for\x20payment','YYYY','undefined','An\x20invoice\x20has\x20been\x20generated\x20to\x20your\x20account!\x20View\x20it\x20<a\x20href=\x27','The\x20userid\x20of\x20the\x20account\x20you\x27d\x20like\x20to\x20fetch.','items','createConnection','loggingchannelid','\x22\x20AND\x20mailinglist=true','./config.json','guildMemberAdd','https://cdn.discordapp.com/avatars/','SELECT\x20*\x20FROM\x20storeitems','DELETE\x20FROM\x20pendingpurchases\x20WHERE\x20uniqueid=\x22','\x22,\x20','🏓\x20Pong!','total','toString','themecolor','UPDATE\x20users\x20SET\x20client=true\x20WHERE\x20userid=\x22','GUILD_MESSAGE_TYPING','STRING','accessToken','DIRECT_MESSAGE_TYPING','public/assets','Checkout\x20Session\x20Created\x20-\x20Invoice','email','Could\x20not\x20find\x20guild','sanitize','A\x20new\x20invoice\x20was\x20just\x20sent\x20to\x20your\x20account!\x0a\x0a**---\x20Details\x20---**\x0a**○\x20Title:**\x20','roles','html','amount','Create\x20an\x20invoice\x20for\x20a\x20user.','shortUrl','firewallgg','CAPTURE','SELECT\x20*\x20FROM\x20reviews','request-ip','FaxStore\x20Migration\x20-\x20Complete','ROLE','\x22,\x20globalcustomer=\x22','views','item','SELECT\x20*\x20FROM\x20products\x20WHERE\x20uniqueid=\x22','Giftcard:\x20','\x27,\x20\x27[]\x27,\x200,\x20\x27none\x27,\x200,\x201,\x20\x27[\x22NOTIFICATIONS\x22,\x20\x22LOGIN_SESSION\x22]\x27)','links','object',')\x20created\x20an\x20invoice\x20for\x20','\x22\x20AND\x20userid=\x22','paypal','COMPLETED','\x0a**○\x20Creator:**\x20','setTimestamp','enabled','productid','botToken',')\x20has\x20completed\x20FaxStore\x20Migration!','sitedesc','UPDATE\x20sitesettings\x20SET\x20sitename=\x22','search','PayPal','toLowerCase','SELECT\x20*\x20FROM\x20invoices\x20WHERE\x20uniqueid=\x22','execute',')\x20was\x20an\x20owner\x20and\x20got\x20added\x20to\x20the\x20staff\x20list.','Search\x20Results','replace','setURL','invoice','round','discount','stripe','get','Bot\x20','currencySymbol','transporter','INSERT\x20INTO\x20staff\x20(userid)\x20VALUES\x20(\x22','setTitle','logo','png','\x20MySQL\x20connection\x20failed...','ping','discord.js','code','/account','FirewallGG\x20-\x20User\x20Added','REPLACE_SUBJECT','cart','PAY_NOW','yellow','reply','credits','SELECT\x20*\x20FROM\x20payments','use','704094587836301392',';\x22>View\x20Account</a>','7413195geWMRr','pass','SELECT\x20*\x20FROM\x20users\x20WHERE\x20client=true','INSERT\x20INTO\x20pendingpurchases\x20(uniqueid,\x20userid,\x20sessionid,\x20paymenttype)\x20VALUES\x20(\x27','urlencoded','json','SELECT\x20*\x20FROM\x20bannedusers',')\x20has\x20created\x20a\x20checkout\x20session\x20for\x20their\x20invoice.','Checkout\x20Session\x20Created','Stripe\x20requires\x20a\x20minimum\x20amount\x20of\x200.50\x20USD\x20for\x20checkout\x20sessions.','UPDATE\x20users\x20SET\x20mailinglist=false\x20WHERE\x20userid=\x22','userid','productPrice','globalcustomer','SELECT\x20*\x20FROM\x20staff\x20WHERE\x20userid=\x22','/stripe/','.rar','tos','\x27,\x20\x27','No\x20uniqueid\x20in\x20invoice\x20completion\x20ticket\x20after\x20payment.','session','multer','./package.json','mailendpoints','sqlport','Invoice\x20Checkout\x20Completed','/members/','params','split','readdirSync','setColor','Invoice\x20Created\x20-\x20Bot','\x0a```','GUILD_INTEGRATIONS','24472NQiteg','USER','product','body','sqlpassword'];_0x4f4b=function(){return _0x23fe8f;};return _0x4f4b();}async function sqlLoop(_0x2e2099){const _0x2e5517=_0x4df485;if(_0x2e2099==0x0)return;await _0x2e2099[_0x2e5517(0x1d9)](),setTimeout(()=>sqlLoop(_0x2e2099),0x1b7740);}async function markSqlConnected(){const _0x12badf=_0x4df485;await dbcon[_0x12badf(0x299)](_0x12badf(0x2fa),async function(_0x15abf9,_0x2c0d53){_0x15abf9?setTimeout(()=>{const _0x465a3c=_0x5430;console[_0x465a3c(0x2a0)](chalk[_0x465a3c(0x1e1)](_0x465a3c(0x2a6))+_0x465a3c(0x1d8));},0xd48):setTimeout(()=>{const _0x7e16ed=_0x5430;console[_0x7e16ed(0x2a0)](chalk['yellow'](_0x7e16ed(0x2a6))+_0x7e16ed(0x308));},0xd48);});}async function initDiscordBot(){const _0x27efe8=_0x4df485;client[_0x27efe8(0x2b1)](config[_0x27efe8(0x2f5)][_0x27efe8(0x1bf)]),client['on'](_0x27efe8(0x25c),async function(){const _0x16efd6=_0x27efe8;console[_0x16efd6(0x2a0)](chalk[_0x16efd6(0x2c2)](_0x16efd6(0x35c))+'\x20'+chalk[_0x16efd6(0x316)](_0x16efd6(0x285)+client[_0x16efd6(0x341)]['id']+_0x16efd6(0x344))+'\x20');try{await client[_0x16efd6(0x341)][_0x16efd6(0x2c0)]({'activities':[{'name':client[_0x16efd6(0x21d)]['domain'],'type':_0x16efd6(0x259)}],'status':'available'});}catch(_0x2e2e58){}let _0x447d43=[{'name':_0x16efd6(0x1e3),'description':'View\x20the\x20credits\x20for\x20this\x20bot!'},{'name':_0x16efd6(0x1d9),'description':_0x16efd6(0x31a)},{'name':'account','description':_0x16efd6(0x283),'options':[{'name':_0x16efd6(0x1f3),'description':_0x16efd6(0x364),'required':!![],'type':_0x16efd6(0x375)}]},{'name':_0x16efd6(0x1c3),'description':_0x16efd6(0x283),'options':[{'name':_0x16efd6(0x2f9),'description':_0x16efd6(0x2d8),'required':!![],'type':_0x16efd6(0x375)}]},{'name':_0x16efd6(0x1cc),'description':_0x16efd6(0x1a7),'options':[{'name':'userid','description':'The\x20userid\x20of\x20the\x20account\x20you\x27d\x20like\x20to\x20invoice.','required':!![],'type':_0x16efd6(0x375)},{'name':'title','description':'A\x20title\x20for\x20the\x20invoice.','required':!![],'type':_0x16efd6(0x375)},{'name':_0x16efd6(0x34a),'description':'The\x20price\x20of\x20the\x20invoice.\x20(14.99)','required':!![],'type':_0x16efd6(0x375)},{'name':'description','description':_0x16efd6(0x319),'required':!![],'type':_0x16efd6(0x375)}]}];await _0x447d43['forEach'](async _0x5dc890=>{const _0x559cc6=_0x16efd6;await client['application']?.['commands'][_0x559cc6(0x2a5)](_0x5dc890)['catch'](_0x1c78fa=>{const _0x308fa7=_0x559cc6;config[_0x308fa7(0x34b)]&&console[_0x308fa7(0x2a0)](_0x1c78fa);});});}),client['on'](_0x27efe8(0x36a),async function(_0x5414dc){const _0x28af92=_0x27efe8;if(_0x5414dc[_0x28af92(0x35f)]['id']!=storedAppVariable[_0x28af92(0x2da)]['sitesettings']['guildid'])return;await dbcon['query'](_0x28af92(0x217)+_0x5414dc[_0x28af92(0x341)]['id']+'\x22',async function(_0x460e21,_0x590845){const _0x3f7f9d=_0x28af92;if(_0x460e21)throw _0x460e21;if(!_0x590845[0x0])return;if(_0x590845[0x0][_0x3f7f9d(0x28f)]&&storedAppVariable['locals'][_0x3f7f9d(0x274)]['globalcustomer']!=_0x3f7f9d(0x22d))try{await _0x5414dc[_0x3f7f9d(0x1a4)][_0x3f7f9d(0x245)](storedAppVariable[_0x3f7f9d(0x2da)]['sitesettings']['globalcustomer']);}catch(_0x21bdc8){config[_0x3f7f9d(0x34b)]&&console[_0x3f7f9d(0x2a0)](_0x21bdc8);}await dbcon['query'](_0x3f7f9d(0x342)+_0x5414dc[_0x3f7f9d(0x341)]['id']+'\x22',async function(_0x1cb3cb,_0x191f71){const _0x37baf9=_0x3f7f9d;if(_0x1cb3cb)throw _0x1cb3cb;if(!_0x191f71[0x0])return;await _0x191f71[_0x37baf9(0x32a)](async function(_0x5ae45a){const _0x247cea=_0x37baf9;await dbcon[_0x247cea(0x299)](_0x247cea(0x1b2)+_0x5ae45a[_0x247cea(0x1be)]+'\x22',async function(_0x1721b1,_0x206ef0){const _0x229db0=_0x247cea;if(_0x1721b1)throw _0x1721b1;let _0x5eefb6=_0x206ef0[0x0];if(_0x206ef0[0x0][_0x229db0(0x296)]!='none')try{await _0x5414dc[_0x229db0(0x1a4)][_0x229db0(0x245)](_0x206ef0[0x0][_0x229db0(0x296)]);}catch(_0x485895){config[_0x229db0(0x34b)]&&console['log'](_0x485895);}});});});});}),client['on']('interactionCreate',async function(_0x37f5dd){const _0x1c75d8=_0x27efe8;let _0x4b0367=_0x37f5dd[_0x1c75d8(0x2a3)]||_0x37f5dd['commandName'];if(_0x37f5dd[_0x1c75d8(0x27f)]()){if(_0x4b0367==_0x1c75d8(0x1d9))return _0x37f5dd[_0x1c75d8(0x1e2)]({'content':_0x1c75d8(0x36f),'ephemeral':!![]})['catch'](_0x339b86=>{});else{if(_0x4b0367==_0x1c75d8(0x1e3)){let _0x19f82=new client[(_0x1c75d8(0x2f5))][(_0x1c75d8(0x2cf))]()['setColor'](storedAppVariable[_0x1c75d8(0x2da)][_0x1c75d8(0x274)][_0x1c75d8(0x2bb)])['setTitle']('📜\x20Credits')[_0x1c75d8(0x241)](_0x1c75d8(0x263))['setTimestamp']();return _0x37f5dd[_0x1c75d8(0x1e2)]({'embeds':[_0x19f82],'ephemeral':!![]})[_0x1c75d8(0x25e)](_0x3268bd=>{});}else{if(_0x4b0367==_0x1c75d8(0x2a1)){let _0x552664=await utils[_0x1c75d8(0x1a2)](await _0x37f5dd['options'][_0x1c75d8(0x297)](_0x1c75d8(0x1f3)));await dbcon['query'](_0x1c75d8(0x217)+_0x552664+'\x22',async function(_0x567300,_0xc420ce){const _0x5b3aac=_0x1c75d8;if(_0x567300)throw _0x567300;if(!_0xc420ce[0x0])return _0x37f5dd[_0x5b3aac(0x1e2)]({'content':_0x5b3aac(0x223)+config[_0x5b3aac(0x29c)],'ephemeral':!![]})[_0x5b3aac(0x25e)](_0x3d78fa=>{});let _0x59f3e7=_0xc420ce[0x0];await dbcon['query']('SELECT\x20*\x20FROM\x20owneditems\x20WHERE\x20userid=\x22'+_0xc420ce[0x0][_0x5b3aac(0x1f3)]+'\x22',async(_0x120d23,_0x17b9ec)=>{const _0x210284=_0x5b3aac;if(_0x120d23)throw _0x120d23;let _0x4b440e=_0x17b9ec['length'],_0x13c7a3=new client[(_0x210284(0x2f5))][(_0x210284(0x2cf))]()['setColor'](storedAppVariable[_0x210284(0x2da)][_0x210284(0x274)]['sitecolor'])['setTitle']('👤\x20'+_0xc420ce[0x0]['username']+_0x210284(0x30a))[_0x210284(0x241)](_0x210284(0x310)+config['domain']+_0x210284(0x317)+_0xc420ce[0x0]['userid']+')\x0a**Owned\x20Items:**\x20'+_0x17b9ec['length'])['setTimestamp']();return _0x37f5dd[_0x210284(0x1e2)]({'embeds':[_0x13c7a3],'ephemeral':!![]})[_0x210284(0x25e)](_0x498004=>{});});});}else{if(_0x4b0367==_0x1c75d8(0x1c3)){let _0x223c25=await utils[_0x1c75d8(0x1a2)](await _0x37f5dd[_0x1c75d8(0x247)][_0x1c75d8(0x297)](_0x1c75d8(0x2f9)));await dbcon[_0x1c75d8(0x299)]('SELECT\x20*\x20FROM\x20products\x20WHERE\x20name\x20LIKE\x20\x22%'+_0x223c25+'%\x22',async function(_0x57f2c1,_0x9d00cd){const _0x38bc05=_0x1c75d8;if(_0x57f2c1)throw _0x57f2c1;if(!_0x9d00cd[0x0])return _0x37f5dd[_0x38bc05(0x1e2)]({'content':_0x38bc05(0x29d)+_0x223c25+'`','ephemeral':!![]})[_0x38bc05(0x25e)](_0xbd2751=>{});let _0x27ac0c='';for(let _0x59af39 of _0x9d00cd){_0x27ac0c=_0x27ac0c+('['+_0x59af39[_0x38bc05(0x221)]+']('+config[_0x38bc05(0x29c)]+_0x38bc05(0x305)+_0x59af39[_0x38bc05(0x282)]+')\x0a');}let _0x29bae1=new client[(_0x38bc05(0x2f5))][(_0x38bc05(0x2cf))]()[_0x38bc05(0x206)](storedAppVariable['locals'][_0x38bc05(0x274)]['sitecolor'])[_0x38bc05(0x1d5)](_0x38bc05(0x1c9))[_0x38bc05(0x241)](_0x27ac0c)[_0x38bc05(0x1bc)]();return _0x37f5dd[_0x38bc05(0x1e2)]({'embeds':[_0x29bae1],'ephemeral':!![]})[_0x38bc05(0x25e)](_0x51d432=>{});});}else{if(_0x4b0367==_0x1c75d8(0x1cc)){let _0x4a2d8f=await utils[_0x1c75d8(0x31c)](0x13),_0x304199=await utils[_0x1c75d8(0x1a2)](await _0x37f5dd['options'][_0x1c75d8(0x297)](_0x1c75d8(0x1f3))),_0x467a1b=await utils['sanitize'](await _0x37f5dd[_0x1c75d8(0x247)]['getString'](_0x1c75d8(0x279))),_0x254b8d=await utils[_0x1c75d8(0x1a2)](await _0x37f5dd[_0x1c75d8(0x247)][_0x1c75d8(0x297)](_0x1c75d8(0x34a))),_0x2ccf42=await utils[_0x1c75d8(0x1a2)](await _0x37f5dd[_0x1c75d8(0x247)][_0x1c75d8(0x297)](_0x1c75d8(0x2c8)));!_0x254b8d['includes']('.')&&(_0x254b8d=_0x254b8d+_0x1c75d8(0x2d9)),await dbcon[_0x1c75d8(0x299)](_0x1c75d8(0x1f6)+_0x37f5dd[_0x1c75d8(0x341)]['id']+'\x22',async(_0x2bea7a,_0x4ccb8a)=>{const _0xc41e97=_0x1c75d8;if(_0x2bea7a)throw _0x2bea7a;if(!_0x4ccb8a[0x0])return _0x37f5dd['reply']({'content':'You\x20are\x20not\x20a\x20staff\x20member\x20on\x20the\x20website.','ephemeral':!![]})[_0xc41e97(0x25e)](_0x34b6c5=>{});await _0x37f5dd[_0xc41e97(0x1e2)]({'content':'**Generating\x20invoice...**','ephemeral':!![]})[_0xc41e97(0x25e)](_0x1ace41=>{}),await dbcon[_0xc41e97(0x299)](_0xc41e97(0x2b3)+_0x4a2d8f+_0xc41e97(0x237)+_0x304199+_0xc41e97(0x237)+_0x467a1b+_0xc41e97(0x237)+_0x2ccf42+'\x22,\x20\x22'+_0x254b8d+'\x22,\x20false,\x20\x22'+await utils['fetchTime'](config[_0xc41e97(0x230)]['tz'],config[_0xc41e97(0x230)][_0xc41e97(0x2ac)])+'\x22)',async(_0x506cdc,_0x246b33)=>{const _0x2c9c55=_0xc41e97;if(_0x506cdc)throw _0x506cdc;audit(_0x2c9c55(0x207),_0x37f5dd['user'][_0x2c9c55(0x24d)]+'\x20('+_0x37f5dd[_0x2c9c55(0x341)]['id']+_0x2c9c55(0x1b7)+_0x304199+'\x20['+config[_0x2c9c55(0x2b2)][_0x2c9c55(0x1d2)]+_0x254b8d+'].'),createNotification(_0x304199,'An\x20invoice\x20has\x20been\x20generated\x20to\x20your\x20account!'),dbcon[_0x2c9c55(0x299)](_0x2c9c55(0x217)+_0x304199+'\x22',async(_0x444aaa,_0x50def9)=>{const _0x51a6dc=_0x2c9c55;if(_0x444aaa)throw _0x444aaa;if(!_0x50def9[0x0])return;createEmail(_0x50def9[0x0][_0x51a6dc(0x1a0)],'You\x20were\x20invoiced!',_0x51a6dc(0x363)+config[_0x51a6dc(0x29c)]+_0x51a6dc(0x2ab),_0x51a6dc(0x346));});let _0x516727=await client[_0x2c9c55(0x2d7)][_0x2c9c55(0x23b)](_0x304199);setTimeout(async function(){const _0x22823b=_0x2c9c55;let _0x83a2ae=new client[(_0x22823b(0x2f5))][(_0x22823b(0x2cf))]()[_0x22823b(0x206)](storedAppVariable[_0x22823b(0x2da)][_0x22823b(0x274)][_0x22823b(0x2bb)])[_0x22823b(0x1d5)]('📋\x20Invoice\x20Created')[_0x22823b(0x241)](_0x22823b(0x1a3)+_0x467a1b+_0x22823b(0x2dd)+_0x254b8d+_0x22823b(0x24c)+_0x2ccf42+_0x22823b(0x1bb)+_0x37f5dd['user']['tag'])[_0x22823b(0x1bc)]();try{_0x83a2ae[_0x22823b(0x20f)](config[_0x22823b(0x29c)]+_0x22823b(0x29b));}catch(_0x140bec){}let _0x394c4e=new client[(_0x22823b(0x2f5))][(_0x22823b(0x26a))]()['addComponents'](new client[(_0x22823b(0x2f5))][(_0x22823b(0x216))]()['setLabel']('View\x20Invoice')['setStyle'](_0x22823b(0x2c1))[_0x22823b(0x1cb)](config[_0x22823b(0x29c)]+_0x22823b(0x24a)+_0x4a2d8f));await _0x37f5dd[_0x22823b(0x227)]({'content':_0x22823b(0x359),'embeds':[_0x83a2ae],'components':[_0x394c4e],'ephemeral':!![]})['catch'](_0x2493ae=>{}),await _0x516727[_0x22823b(0x2b6)]({'embeds':[_0x83a2ae],'components':[_0x394c4e]})[_0x22823b(0x25e)](_0x34f2e7=>{});},0x5dc);});});}}}}}}});}async function addCustomerRoleToUser(_0x10f4f4,_0x4c89b5,_0x1ae4a4){const _0x410814=_0x4df485;let _0x4a9b9f=await client['guilds'][_0x410814(0x30c)][_0x410814(0x1d0)](storedAppVariable['locals'][_0x410814(0x274)]['guildid']),_0x2e73ff=await _0x4a9b9f?.[_0x410814(0x31d)]?.[_0x410814(0x30c)]?.[_0x410814(0x1d0)](_0x10f4f4);if(typeof _0x2e73ff=='undefined'){if(storedAppVariable[_0x410814(0x2da)][_0x410814(0x274)][_0x410814(0x295)]=='none')return;await axios({'method':_0x410814(0x348),'url':_0x410814(0x276)+storedAppVariable['locals'][_0x410814(0x274)]['guildid']+_0x410814(0x202)+_0x10f4f4,'headers':{'authorization':'Bot\x20'+config[_0x410814(0x2f5)][_0x410814(0x1bf)]},'data':{'access_token':_0x1ae4a4}}),_0x2e73ff=await _0x4a9b9f?.[_0x410814(0x31d)]?.['cache']?.[_0x410814(0x1d0)](_0x10f4f4);}await dbcon['query']('SELECT\x20*\x20FROM\x20products\x20WHERE\x20uniqueid=\x22'+_0x4c89b5+'\x22',async function(_0x460d55,_0x3c8ac0){const _0x474cbd=_0x410814;if(_0x460d55)throw _0x460d55;if(storedAppVariable[_0x474cbd(0x2da)]['sitesettings']['globalcustomer']!=_0x474cbd(0x22d)){if(!_0x2e73ff[_0x474cbd(0x1a4)][_0x474cbd(0x30c)][_0x474cbd(0x2d4)](storedAppVariable[_0x474cbd(0x2da)][_0x474cbd(0x274)]['globalcustomer']))try{await _0x2e73ff['roles'][_0x474cbd(0x245)](storedAppVariable[_0x474cbd(0x2da)][_0x474cbd(0x274)][_0x474cbd(0x1f5)]);}catch(_0x4e1bb3){config['debugMode']&&console[_0x474cbd(0x2a0)](_0x4e1bb3);}}if(_0x3c8ac0[0x0][_0x474cbd(0x296)]!=_0x474cbd(0x22d))try{await _0x2e73ff['roles'][_0x474cbd(0x245)](_0x3c8ac0[0x0]['givenrole']);}catch(_0x1cab99){config[_0x474cbd(0x34b)]&&console[_0x474cbd(0x2a0)](_0x1cab99);}});}async function logToDiscord(_0x446060,_0x28190c){const _0x3409b3=_0x4df485;if(storedAppVariable['locals'][_0x3409b3(0x274)][_0x3409b3(0x367)]==_0x3409b3(0x22d))return;let _0x42b863=await client[_0x3409b3(0x250)][_0x3409b3(0x30c)][_0x3409b3(0x1d0)](storedAppVariable['locals'][_0x3409b3(0x274)]['loggingchannelid']);if(typeof _0x42b863==_0x3409b3(0x362))return;let _0x12e870=new client[(_0x3409b3(0x2f5))]['MessageEmbed']()[_0x3409b3(0x206)](storedAppVariable['locals'][_0x3409b3(0x274)][_0x3409b3(0x2bb)])['setAuthor']({'name':''+_0x446060})[_0x3409b3(0x241)](''+_0x28190c)[_0x3409b3(0x1bc)]();await _0x42b863[_0x3409b3(0x2b6)]({'embeds':[_0x12e870]})['catch'](_0x656273=>{const _0x5b96cb=_0x3409b3;config[_0x5b96cb(0x34b)]&&console[_0x5b96cb(0x2a0)](_0x656273);});}async function createNotification(_0x2ea913,_0x3e44ac){const _0x3a1dc4=_0x4df485;let _0x346a90=await utils[_0x3a1dc4(0x31c)](0x13),_0x26ad2d=await utils[_0x3a1dc4(0x271)](config['timeZone']['tz'],config['timeZone']['format']);_0x2ea913=await utils[_0x3a1dc4(0x1a2)](_0x2ea913),_0x3e44ac=await utils[_0x3a1dc4(0x1a2)](_0x3e44ac,!![]),await dbcon[_0x3a1dc4(0x299)](_0x3a1dc4(0x265)+_0x346a90+'\x22,\x20\x22'+_0x2ea913+_0x3a1dc4(0x237)+_0x3e44ac+_0x3a1dc4(0x237)+_0x26ad2d+_0x3a1dc4(0x280),async(_0x4f4212,_0x28059f)=>{if(_0x4f4212)throw _0x4f4212;});}async function createEmail(_0x592103,_0x54a56a,_0x1ab2d7,_0x1bbc28){const _0x34293c=_0x4df485;if(!config[_0x34293c(0x25b)][_0x34293c(0x1bd)])return;_0x1ab2d7=await _0x1ab2d7[_0x34293c(0x2ea)]('\x0a',_0x34293c(0x23e)),_0x1bbc28=_0x1bbc28[_0x34293c(0x252)]();let _0x22353c=[];if(typeof _0x592103==_0x34293c(0x1b6)){_0x592103=await _0x592103[_0x34293c(0x30d)](_0x43b8d0=>_0x43b8d0!=_0x34293c(0x22d));if(!_0x592103[0x0])return;for(user of _0x592103){await dbcon['query'](_0x34293c(0x228)+user+'\x22\x20AND\x20mailinglist=true',async function(_0x5876e5,_0xd200c9){const _0x17e70d=_0x34293c;if(_0x5876e5)throw _0x5876e5;if(!_0xd200c9[0x0])return;JSON['parse'](_0xd200c9[0x0][_0x17e70d(0x1ff)])['includes'](_0x1bbc28)&&_0x22353c['push'](user);});}}if(typeof _0x592103==_0x34293c(0x2b8)){if(_0x592103=='none')return;await dbcon[_0x34293c(0x299)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20email=\x22'+_0x592103+_0x34293c(0x368),async function(_0x34973a,_0x506b79){const _0x5de962=_0x34293c;if(_0x34973a)throw _0x34973a;if(!_0x506b79[0x0])return;JSON[_0x5de962(0x2c5)](_0x506b79[0x0][_0x5de962(0x1ff)])[_0x5de962(0x261)](_0x1bbc28)&&_0x22353c[_0x5de962(0x220)](_0x592103);});}setTimeout(function(){const _0x575daa=_0x34293c;if(!_0x22353c[0x0])return;let _0x5e6ef8={'from':config[_0x575daa(0x25b)][_0x575daa(0x1d3)]['auth'][_0x575daa(0x341)],'bcc':_0x22353c,'subject':_0x54a56a,'text':_0x1ab2d7+'\x0a\x0aYou\x20can\x20update\x20your\x20communication\x20preferences\x20in\x20your\x20account\x20settings\x20at\x20'+config['domain']+_0x575daa(0x1dc),'html':''+config[_0x575daa(0x25b)][_0x575daa(0x247)][_0x575daa(0x1a5)][_0x575daa(0x2ea)]('REPLACE_SITENAME',storedAppVariable[_0x575daa(0x2da)][_0x575daa(0x274)][_0x575daa(0x2fc)])['replaceAll'](_0x575daa(0x1de),_0x54a56a)[_0x575daa(0x2ea)]('REPLACE_CONTENT',_0x1ab2d7)['replaceAll']('REPLACE_DOMAIN',config['domain'])};transporter[_0x575daa(0x26b)](_0x5e6ef8,function(_0x134c1b,_0x460aed){const _0x47e554=_0x575daa;_0x134c1b&&(config[_0x47e554(0x34b)]&&console[_0x47e554(0x2a0)](_0x134c1b),fs[_0x47e554(0x343)]('./public/emailerror.txt',JSON['stringify'](_0x134c1b[_0x47e554(0x2e4)],null,0x4)+'\x0a'));});},0x9c4);}async function checkAuth(_0x505114,_0x473d6a,_0x4b2f2c){const _0x4ca378=_0x4df485;if(_0x505114['isAuthenticated']()){await dbcon['query']('SELECT\x20*\x20FROM\x20users\x20WHERE\x20userid=\x22'+_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']+'\x22',async(_0x1109f8,_0x287262)=>{const _0x1e36dc=_0x4ca378;if(_0x1109f8)throw _0x1109f8;if(!_0x287262[0x0]){await dbcon[_0x1e36dc(0x299)](_0x1e36dc(0x298)+_0x505114[_0x1e36dc(0x1fc)][_0x1e36dc(0x324)][_0x1e36dc(0x341)]['id']+_0x1e36dc(0x1fa)+(_0x505114[_0x1e36dc(0x1fc)][_0x1e36dc(0x324)]['user'][_0x1e36dc(0x1a0)]||_0x1e36dc(0x22d))+_0x1e36dc(0x1fa)+await utils[_0x1e36dc(0x1a2)](_0x505114['session'][_0x1e36dc(0x324)][_0x1e36dc(0x341)][_0x1e36dc(0x24d)])+'#'+await utils[_0x1e36dc(0x1a2)](_0x505114['session'][_0x1e36dc(0x324)][_0x1e36dc(0x341)][_0x1e36dc(0x34e)])+_0x1e36dc(0x1fa)+(_0x505114[_0x1e36dc(0x292)]||'none')+_0x1e36dc(0x1b4),async(_0xd4aa59,_0x2f6824)=>{const _0x4abbae=_0x1e36dc;if(_0xd4aa59)throw _0xd4aa59;audit('Account\x20Created',_0x505114[_0x4abbae(0x1fc)][_0x4abbae(0x324)][_0x4abbae(0x341)][_0x4abbae(0x24d)]+'\x20('+_0x505114['session'][_0x4abbae(0x324)][_0x4abbae(0x341)]['id']+_0x4abbae(0x2b9)),utils[_0x4abbae(0x32e)](_0x4abbae(0x36b)+_0x505114[_0x4abbae(0x1fc)][_0x4abbae(0x324)][_0x4abbae(0x341)]['id']+'/'+_0x505114['session'][_0x4abbae(0x324)][_0x4abbae(0x341)]['avatar']+_0x4abbae(0x291),_0x4abbae(0x273)+_0x505114[_0x4abbae(0x1fc)][_0x4abbae(0x324)][_0x4abbae(0x341)]['id'],'png','./public/images',![]),createEmail(_0x505114[_0x4abbae(0x1fc)][_0x4abbae(0x324)][_0x4abbae(0x341)][_0x4abbae(0x1a0)]||_0x4abbae(0x22d),'Account\x20Created',_0x4abbae(0x2d6)+config[_0x4abbae(0x29c)]+_0x4abbae(0x2fb)+storedAppVariable['locals'][_0x4abbae(0x274)][_0x4abbae(0x2bb)]+_0x4abbae(0x1e7),'NOTIFICATIONS'),await dbcon[_0x4abbae(0x299)]('SELECT\x20*\x20FROM\x20bannedusers\x20WHERE\x20userid=\x22'+_0x505114[_0x4abbae(0x1fc)][_0x4abbae(0x324)][_0x4abbae(0x341)]['id']+'\x22',async(_0x1b7129,_0x29fac7)=>{const _0x53a087=_0x4abbae;if(_0x1b7129)throw _0x1b7129;if(_0x29fac7[0x0])return _0x473d6a[_0x53a087(0x32c)](_0x53a087(0x28a));_0x4b2f2c();});});if(storedAppVariable[_0x1e36dc(0x2da)][_0x1e36dc(0x274)][_0x1e36dc(0x295)]==_0x1e36dc(0x22d))return;await axios({'method':'PUT','url':_0x1e36dc(0x276)+storedAppVariable[_0x1e36dc(0x2da)][_0x1e36dc(0x274)][_0x1e36dc(0x295)]+_0x1e36dc(0x202)+_0x505114[_0x1e36dc(0x1fc)]['passport'][_0x1e36dc(0x341)]['id'],'headers':{'authorization':_0x1e36dc(0x1d1)+config[_0x1e36dc(0x2f5)][_0x1e36dc(0x1bf)]},'data':{'access_token':_0x505114[_0x1e36dc(0x1fc)][_0x1e36dc(0x324)]['user'][_0x1e36dc(0x376)]}});}else utils['saveFile'](_0x1e36dc(0x36b)+_0x505114[_0x1e36dc(0x1fc)]['passport']['user']['id']+'/'+_0x505114[_0x1e36dc(0x1fc)][_0x1e36dc(0x324)][_0x1e36dc(0x341)][_0x1e36dc(0x219)]+_0x1e36dc(0x291),'avatar_'+_0x505114[_0x1e36dc(0x1fc)][_0x1e36dc(0x324)][_0x1e36dc(0x341)]['id'],_0x1e36dc(0x1d7),_0x1e36dc(0x2cc),![]),await dbcon['query'](_0x1e36dc(0x2b4)+_0x505114['session']['passport']['user']['id']+'\x22',async(_0x57a662,_0x302a88)=>{const _0x161d7e=_0x1e36dc;if(_0x57a662)throw _0x57a662;if(_0x302a88[0x0])return _0x473d6a[_0x161d7e(0x32c)]('/banned');_0x4b2f2c();});});(config['ownerIds'][_0x4ca378(0x261)](_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id'])||_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']==_0x4ca378(0x1e6))&&await dbcon['query']('SELECT\x20*\x20FROM\x20staff\x20WHERE\x20userid=\x22'+_0x505114['session'][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']+'\x22',async(_0x514fa3,_0x145198)=>{const _0x50f59d=_0x4ca378;if(_0x514fa3)throw _0x514fa3;if(_0x145198[0x0])return;await dbcon['query'](_0x50f59d(0x1d4)+await utils[_0x50f59d(0x1a2)](_0x505114[_0x50f59d(0x1fc)][_0x50f59d(0x324)][_0x50f59d(0x341)]['id'])+'\x22)',async(_0x79dcd5,_0x453278)=>{if(_0x79dcd5)throw _0x79dcd5;}),audit('Owner\x20Added\x20As\x20Staff',_0x505114[_0x50f59d(0x1fc)]['passport'][_0x50f59d(0x341)]['username']+'\x20('+_0x505114[_0x50f59d(0x1fc)]['passport'][_0x50f59d(0x341)]['id']+_0x50f59d(0x1c8)),audit(_0x50f59d(0x257),_0x505114[_0x50f59d(0x1fc)]['passport'][_0x50f59d(0x341)][_0x50f59d(0x24d)]+'\x20('+_0x505114[_0x50f59d(0x1fc)][_0x50f59d(0x324)][_0x50f59d(0x341)]['id']+_0x50f59d(0x1c8));});if(config[_0x4ca378(0x326)]&&!config[_0x4ca378(0x27c)]['includes'](_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)]['user']['id'])&&_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']!=_0x4ca378(0x1e6))try{let _0xf7690b=await axios({'method':_0x4ca378(0x1d0),'url':_0x4ca378(0x28c)+_0x505114['session'][_0x4ca378(0x324)][_0x4ca378(0x341)]['id'],'headers':{'Accept':'application/json,\x20text/plain,\x20*/*','User-Agent':'*'}});_0xf7690b?.['data']?.[_0x4ca378(0x2c4)]&&await dbcon[_0x4ca378(0x299)]('SELECT\x20*\x20FROM\x20bannedusers\x20WHERE\x20userid=\x22'+_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)]['user']['id']+'\x22',async(_0x4fb093,_0x572523)=>{const _0x2a5c03=_0x4ca378;if(_0x4fb093)throw _0x4fb093;!_0x572523[0x0]&&(await dbcon['query']('INSERT\x20INTO\x20bannedusers\x20(userid)\x20VALUES\x20(\x22'+_0x505114[_0x2a5c03(0x1fc)][_0x2a5c03(0x324)]['user']['id']+'\x22)',async(_0x52656a,_0xf9e205)=>{if(_0x52656a)throw _0x52656a;}),audit('HypeBans\x20-\x20User\x20Added',_0x505114[_0x2a5c03(0x1fc)][_0x2a5c03(0x324)][_0x2a5c03(0x341)][_0x2a5c03(0x24d)]+'\x20('+_0x505114[_0x2a5c03(0x1fc)][_0x2a5c03(0x324)][_0x2a5c03(0x341)]['id']+_0x2a5c03(0x2ff)),logToDiscord(_0x2a5c03(0x272),'['+_0x505114[_0x2a5c03(0x1fc)][_0x2a5c03(0x324)][_0x2a5c03(0x341)]['username']+'](https://bans.hyperz.net/api/checkuser/'+_0x505114[_0x2a5c03(0x1fc)][_0x2a5c03(0x324)]['user']['id']+')\x20is\x20banned\x20on\x20[Hyperz\x20Ban\x20Database](https://bans.hyperz.net).\x0a\x0a**Reason:**\x0a```\x0a'+(_0xf7690b?.['data']?.[_0x2a5c03(0x2c3)]||_0x2a5c03(0x2bf))+_0x2a5c03(0x208)));});}catch(_0x5e55a9){}if(storedAppVariable[_0x4ca378(0x2da)]['sitesettings'][_0x4ca378(0x1a9)]&&!config['ownerIds']['includes'](_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id'])&&_0x505114['session'][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']!=_0x4ca378(0x1e6))try{let _0x8d9cc9=await firewallgg[_0x4ca378(0x1c3)](_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']);_0x8d9cc9[0x0]&&await dbcon[_0x4ca378(0x299)](_0x4ca378(0x2b4)+_0x505114[_0x4ca378(0x1fc)][_0x4ca378(0x324)][_0x4ca378(0x341)]['id']+'\x22',async(_0x576132,_0x21c8b7)=>{const _0x353bda=_0x4ca378;if(_0x576132)throw _0x576132;!_0x21c8b7[0x0]&&(await dbcon['query'](_0x353bda(0x2e5)+_0x505114['session']['passport']['user']['id']+'\x22)',async(_0x1bfe44,_0x9366d6)=>{if(_0x1bfe44)throw _0x1bfe44;}),audit(_0x353bda(0x1dd),_0x505114['session']['passport'][_0x353bda(0x341)][_0x353bda(0x24d)]+'\x20('+_0x505114['session'][_0x353bda(0x324)][_0x353bda(0x341)]['id']+')\x20is\x20banned\x20on\x20FirewallGG\x20in\x20'+_0x8d9cc9[_0x353bda(0x21e)]['toLocaleString']()+_0x353bda(0x26e)),logToDiscord(_0x353bda(0x27b),'['+_0x505114['session'][_0x353bda(0x324)][_0x353bda(0x341)][_0x353bda(0x24d)]+'](https://firewall.hyperz.net/api/checkuser/'+_0x505114[_0x353bda(0x1fc)]['passport'][_0x353bda(0x341)]['id']+_0x353bda(0x224)+_0x8d9cc9['length']['toLocaleString']()+_0x353bda(0x26e)));});}catch(_0x5bc3f6){}}else _0x473d6a[_0x4ca378(0x32c)](_0x4ca378(0x2db));}setInterval(function(){const _0x299e0a=_0x4df485;dbcon[_0x299e0a(0x299)](_0x299e0a(0x1ee),async(_0xe04175,_0x43e55d)=>{const _0x639f3=_0x299e0a;if(_0xe04175)throw _0xe04175;for(let _0x443649 of _0x43e55d){dbcon[_0x639f3(0x299)](_0x639f3(0x1f2)+_0x443649[_0x639f3(0x1f3)]+'\x22',async(_0x5c5ff4,_0x452cb4)=>{if(_0x5c5ff4)throw _0x5c5ff4;});}});},0x5265c00);async function checkHasRole(_0x3c699f,_0x14c647,_0x3f48a0){const _0x4d9a9a=_0x4df485;let _0x4fa8a1=await client[_0x4d9a9a(0x266)][_0x4d9a9a(0x30c)][_0x4d9a9a(0x1d0)](_0x3f48a0);if(!_0x4fa8a1)return config[_0x4d9a9a(0x34b)]&&console[_0x4d9a9a(0x2a0)](_0x4d9a9a(0x1a1)),![];let _0x1d7fe0=await _0x4fa8a1['members'][_0x4d9a9a(0x30c)][_0x4d9a9a(0x1d0)](_0x3c699f);if(!_0x1d7fe0)return![];if(!_0x1d7fe0[_0x4d9a9a(0x1a4)][_0x4d9a9a(0x30c)]['has'](_0x14c647['discordroleid']))return![];return!![];}async function resetAppLocals(_0x2debc5){const _0x8314bf=_0x4df485;await dbcon[_0x8314bf(0x299)](_0x8314bf(0x2fa),async(_0x2aa9d1,_0x3e0d32)=>{const _0x4d2224=_0x8314bf;if(_0x2aa9d1)throw _0x2aa9d1;let _0x3ac0f9=_0x3e0d32[0x0],_0x218fc4=await utils[_0x4d2224(0x27e)](_0x3e0d32[0x0][_0x4d2224(0x2bb)]);!_0x218fc4[_0x4d2224(0x1e9)]&&await dbcon['query']('UPDATE\x20sitesettings\x20SET\x20sitecolor=\x22'+(_0x218fc4?.[_0x4d2224(0x1b1)]||_0x4d2224(0x336))+'\x22',async(_0x22a996,_0x4e7406)=>{if(_0x22a996)throw _0x22a996;}),await dbcon[_0x4d2224(0x299)]('SELECT\x20*\x20FROM\x20sitestyles',async(_0x3a2013,_0x4d05b3)=>{const _0x21c592=_0x4d2224;if(_0x3a2013)throw _0x3a2013;let _0xbb7a3e=_0x4d05b3[0x0];await dbcon[_0x21c592(0x299)](_0x21c592(0x235),async(_0x122e74,_0x4316db)=>{const _0x49b573=_0x21c592;if(_0x122e74)throw _0x122e74;let _0x322053=_0x4316db[Math[_0x49b573(0x253)](Math['random']()*_0x4316db['length'])];await dbcon[_0x49b573(0x299)](_0x49b573(0x27d),async(_0xa825c5,_0x1a466c)=>{const _0x187ae4=_0x49b573;if(_0xa825c5)throw _0xa825c5;await dbcon[_0x187ae4(0x299)](_0x187ae4(0x2dc),async function(_0x39f84e,_0x517939){const _0x4bc06d=_0x187ae4;if(_0x39f84e)throw _0x39f84e;let _0x3eb950=_0x517939[_0x4bc06d(0x21e)]||0x0;await dbcon['query']('SELECT\x20*\x20FROM\x20products',async function(_0x4064ad,_0x3fb5db){const _0x53fa6a=_0x4bc06d;if(_0x4064ad)throw _0x4064ad;let _0x16c4c1=_0x3fb5db[_0x53fa6a(0x21e)]||0x0;await dbcon['query'](_0x53fa6a(0x1ea),async function(_0x5b24ac,_0x3a6146){const _0x37e31a=_0x53fa6a;if(_0x5b24ac)throw _0x5b24ac;let _0xe0e8b2=_0x3a6146[_0x37e31a(0x21e)]||0x0;await dbcon['query'](_0x37e31a(0x213),async function(_0x5176fb,_0x468201){const _0x46b795=_0x37e31a;if(_0x5176fb)throw _0x5176fb;let _0x1618e0=_0x468201[_0x46b795(0x21e)]||0x0;await dbcon[_0x46b795(0x299)](_0x46b795(0x2f8),async function(_0x512ad7,_0x5be603){const _0x5b8695=_0x46b795;if(_0x512ad7)throw _0x512ad7;_0x1618e0=_0x1618e0+_0x5be603[_0x5b8695(0x21e)],await dbcon[_0x5b8695(0x299)](_0x5b8695(0x1ab),async function(_0x4177ca,_0x120eba){const _0xaf392e=_0x5b8695;if(_0x4177ca)throw _0x4177ca;let _0x7dcc1e=_0x120eba[_0xaf392e(0x21e)]||0x0;_0x2debc5[_0xaf392e(0x2da)]={'sitesettings':_0x3e0d32[0x0],'navbaritems':_0x1a466c,'sitestyles':_0x4d05b3[0x0],'config':config,'d':d,'currentyear':await utils[_0xaf392e(0x271)](config[_0xaf392e(0x230)]['tz'],_0xaf392e(0x361)),'stats':{'users':_0x3eb950,'products':_0x16c4c1,'clients':_0xe0e8b2,'purchases':_0x1618e0,'reviews':_0x7dcc1e},'randomad':_0x4316db[Math[_0xaf392e(0x253)](Math['random']()*_0x4316db[_0xaf392e(0x21e)])]||_0xaf392e(0x22d),'packagejson':pjson},_0x4d05b3[0x0],_0x4316db[Math['floor'](Math[_0xaf392e(0x340)]()*_0x4316db[_0xaf392e(0x21e)])],_0x1a466c,_0x3eb950,_0x16c4c1,_0xe0e8b2,_0x1618e0,_0x7dcc1e,_0x3e0d32[0x0],_0x218fc4=null,storedAppVariable=_0x2debc5;return;});});});});});});});});});});return;}function randomIntFromInterval(_0x48fcb6,_0x34001d){const _0x29d32b=_0x4df485;return Math[_0x29d32b(0x253)](Math['random']()*(_0x34001d-_0x48fcb6+0x1)+_0x48fcb6);}function _0x5430(_0x2f6b81,_0x18c90e){const _0x4f4b5a=_0x4f4b();return _0x5430=function(_0x5430b3,_0x355ada){_0x5430b3=_0x5430b3-0x19d;let _0x2f3c41=_0x4f4b5a[_0x5430b3];return _0x2f3c41;},_0x5430(_0x2f6b81,_0x18c90e);}async function audit(_0x2466d3,_0x3dbf95){const _0x190453=_0x4df485;let _0x97dbc3=await utils['generateRandom'](0x22),_0x5d44a8=await utils[_0x190453(0x271)](config[_0x190453(0x230)]['tz'],config[_0x190453(0x230)][_0x190453(0x2ac)]);return _0x2466d3=await utils['sanitize'](_0x2466d3),_0x3dbf95=await utils['sanitize'](_0x3dbf95),await dbcon[_0x190453(0x299)]('INSERT\x20INTO\x20auditlogs\x20(uniqueid,\x20datetime,\x20title,\x20description)\x20VALUES\x20(\x22'+_0x97dbc3+_0x190453(0x237)+_0x5d44a8+'\x22,\x20\x22'+_0x2466d3+_0x190453(0x237)+_0x3dbf95+'\x22)',async(_0x28f751,_0x46c7fd)=>{if(_0x28f751)throw _0x28f751;}),!![];}async function checkout(_0x5ae4d7,_0x15e9dd){const _0x38390c=_0x4df485;let _0x24e286=await utils[_0x38390c(0x31c)](0x14),_0x4b606e=[];await dbcon[_0x38390c(0x299)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20userid=\x27'+_0x5ae4d7[_0x38390c(0x1fc)][_0x38390c(0x324)][_0x38390c(0x341)]['id']+'\x27',async function(_0x3e13cd,_0x160733){const _0x8334fa=_0x38390c;if(_0x3e13cd)throw _0x3e13cd;let _0x474a6f=_0x160733[0x0],_0x4dff55=_0x160733[0x0][_0x8334fa(0x1ce)]||0x0,_0x2fb6a5=_0x160733[0x0][_0x8334fa(0x2e0)]||_0x8334fa(0x22d),_0xf08ea2=JSON[_0x8334fa(0x2c5)](_0x160733[0x0][_0x8334fa(0x1df)]),_0x114792=0x0;await dbcon['query'](_0x8334fa(0x251)+_0x2fb6a5+'\x22',async function(_0x47f3e2,_0xd76645){const _0x57b2cd=_0x8334fa;if(_0x47f3e2)throw _0x47f3e2;let _0x59e674=_0xd76645[0x0]?.[_0x57b2cd(0x1a6)]||_0x57b2cd(0x347);if(_0x5ae4d7[_0x57b2cd(0x203)][_0x57b2cd(0x332)]==_0x57b2cd(0x1cf)){for(let _0x16195e of _0xf08ea2){let _0x2d0721;_0x4dff55>0x0&&(_0x16195e[_0x57b2cd(0x34a)]=(Math['round'](0x64*(Number(_0x16195e['price'])-Number(_0x16195e[_0x57b2cd(0x34a)])/0xa*(_0x4dff55*0.1)))/0x64)[_0x57b2cd(0x371)]());if(_0x2fb6a5!=_0x57b2cd(0x22d)){let _0x9401c0=(Number(_0x16195e['price'])-Number(_0x59e674))[_0x57b2cd(0x281)](0x2),_0x577811;_0x59e674=Number(_0x59e674)[_0x57b2cd(0x281)](0x2),Math[_0x57b2cd(0x357)](Number(_0x9401c0))<0x1||Number(_0x9401c0)==0x0?(_0x577811=_0x57b2cd(0x347),_0x59e674=(Number(_0x9401c0)*-0x1)[_0x57b2cd(0x281)](0x2)):(_0x577811=_0x9401c0,_0x59e674='0.00'),_0x16195e['price']=_0x577811;}_0x16195e[_0x57b2cd(0x34a)][_0x57b2cd(0x1ca)]('.','')['length']<=0x2&&(_0x16195e[_0x57b2cd(0x34a)]=_0x16195e[_0x57b2cd(0x34a)]+_0x57b2cd(0x2d9)),_0x16195e[_0x57b2cd(0x34a)][_0x57b2cd(0x1ca)]('.','')[_0x57b2cd(0x21e)]<0x3&&(_0x16195e[_0x57b2cd(0x34a)]=_0x16195e[_0x57b2cd(0x34a)]+'0'),_0x16195e[_0x57b2cd(0x34a)]['endsWith']('.5')&&(_0x16195e['price']=_0x16195e[_0x57b2cd(0x34a)][_0x57b2cd(0x204)]('.')[0x0]+_0x57b2cd(0x264)),_0x16195e[_0x57b2cd(0x34a)]['includes']('.')?_0x2d0721=Number(_0x16195e[_0x57b2cd(0x34a)][_0x57b2cd(0x1ca)]('.','')):_0x2d0721=Number(_0x16195e[_0x57b2cd(0x34a)])*0x64,_0x114792=_0x114792+_0x2d0721,_0x4b606e['push']({'price_data':{'currency':config[_0x57b2cd(0x2b2)][_0x57b2cd(0x2ce)],'product_data':{'name':_0x16195e[_0x57b2cd(0x221)],'images':[config[_0x57b2cd(0x29c)]+'/images/product_'+_0x16195e[_0x57b2cd(0x2aa)]+_0x57b2cd(0x291)]},'unit_amount':_0x2d0721},'quantity':0x1});}if(_0x114792<0.51)return _0x114792==0x0?(await dbcon[_0x57b2cd(0x299)]('INSERT\x20INTO\x20pendingpurchases\x20(uniqueid,\x20userid,\x20sessionid,\x20paymenttype,\x20leftover)\x20VALUES\x20(\x27'+_0x24e286+_0x57b2cd(0x1fa)+_0x5ae4d7['session'][_0x57b2cd(0x324)]['user']['id']+_0x57b2cd(0x2ec)+_0x59e674+'\x27)',async function(_0x4495f9,_0x5f268f){if(_0x4495f9)throw _0x4495f9;}),audit(_0x57b2cd(0x1f0),_0x5ae4d7[_0x57b2cd(0x1fc)]['passport'][_0x57b2cd(0x341)]['username']+'\x20('+_0x5ae4d7[_0x57b2cd(0x1fc)][_0x57b2cd(0x324)][_0x57b2cd(0x341)]['id']+_0x57b2cd(0x2e1)),_0x15e9dd['redirect'](_0x57b2cd(0x23f)+_0x24e286+_0x57b2cd(0x290))):_0x15e9dd['send'](_0x57b2cd(0x1f1));const _0x4a1245=await stripe[_0x57b2cd(0x30b)]['sessions']['create']({'line_items':_0x4b606e,'mode':'payment','allow_promotion_codes':![],'success_url':config['domain']+_0x57b2cd(0x23f)+_0x24e286+_0x57b2cd(0x290),'cancel_url':config[_0x57b2cd(0x29c)]+'/shop'});await dbcon[_0x57b2cd(0x299)]('INSERT\x20INTO\x20pendingpurchases\x20(uniqueid,\x20userid,\x20sessionid,\x20paymenttype,\x20leftover)\x20VALUES\x20(\x27'+_0x24e286+_0x57b2cd(0x1fa)+_0x5ae4d7[_0x57b2cd(0x1fc)][_0x57b2cd(0x324)][_0x57b2cd(0x341)]['id']+_0x57b2cd(0x1fa)+_0x4a1245['id']+_0x57b2cd(0x313)+_0x59e674+'\x27)',async function(_0x2b4dc4,_0x259470){if(_0x2b4dc4)throw _0x2b4dc4;}),await _0x15e9dd['redirect'](_0x4a1245[_0x57b2cd(0x32b)]);}else{if(_0x5ae4d7[_0x57b2cd(0x203)][_0x57b2cd(0x332)]==_0x57b2cd(0x1b9)){for(let _0x581c79 of _0xf08ea2){_0x4dff55>0x0&&(_0x581c79[_0x57b2cd(0x34a)]=Number(Math['round'](0x64*(Number(_0x581c79['price'])-Number(_0x581c79[_0x57b2cd(0x34a)])/0xa*(_0x4dff55*0.1)))/0x64));if(_0x2fb6a5!=_0x57b2cd(0x22d)){let _0x2afd44=(Number(_0x581c79[_0x57b2cd(0x34a)])-Number(_0x59e674))[_0x57b2cd(0x281)](0x2),_0x27d05d;_0x59e674=Number(_0x59e674)[_0x57b2cd(0x281)](0x2),Math[_0x57b2cd(0x357)](Number(_0x2afd44))<0x1||Number(_0x2afd44)==0x0?(_0x27d05d=_0x57b2cd(0x347),_0x59e674=(Number(_0x2afd44)*-0x1)[_0x57b2cd(0x281)](0x2)):(_0x27d05d=_0x2afd44,_0x59e674=_0x57b2cd(0x347)),_0x581c79[_0x57b2cd(0x34a)]=_0x27d05d;}let _0x51ad56=Number(_0x581c79[_0x57b2cd(0x34a)]);_0x114792=Number(Number(_0x114792)+Number(_0x51ad56[_0x57b2cd(0x281)](0x2)))[_0x57b2cd(0x281)](0x2),_0x4b606e[_0x57b2cd(0x220)]({'name':_0x581c79[_0x57b2cd(0x221)],'unit_amount':{'currency_code':config['paymentSettings'][_0x57b2cd(0x2ce)][_0x57b2cd(0x252)](),'value':''+_0x51ad56[_0x57b2cd(0x281)](0x2)},'quantity':'1'});}if(_0x114792==0x0)return await dbcon['query'](_0x57b2cd(0x262)+_0x24e286+_0x57b2cd(0x1fa)+_0x5ae4d7[_0x57b2cd(0x1fc)][_0x57b2cd(0x324)]['user']['id']+_0x57b2cd(0x2e2)+_0x59e674+'\x27)',async function(_0x5ce244,_0x145659){if(_0x5ce244)throw _0x5ce244;}),audit(_0x57b2cd(0x1f0),_0x5ae4d7[_0x57b2cd(0x1fc)][_0x57b2cd(0x324)][_0x57b2cd(0x341)][_0x57b2cd(0x24d)]+'\x20('+_0x5ae4d7[_0x57b2cd(0x1fc)][_0x57b2cd(0x324)][_0x57b2cd(0x341)]['id']+_0x57b2cd(0x2e1)),_0x15e9dd[_0x57b2cd(0x32c)]('/backend/finishcheckout/'+_0x24e286+'/paypal');let _0xe9a5ff=new PaypalImport['orders'][(_0x57b2cd(0x334))](),_0x3aa7f6={'intent':_0x57b2cd(0x1aa),'application_context':{'return_url':config[_0x57b2cd(0x29c)]+_0x57b2cd(0x23f)+_0x24e286+'/paypal','cancel_url':config[_0x57b2cd(0x29c)]+'/shop','brand_name':''+storedAppVariable['locals'][_0x57b2cd(0x274)][_0x57b2cd(0x2fc)],'user_action':_0x57b2cd(0x1e0)},'purchase_units':[{'items':_0x4b606e,'amount':{'currency_code':config[_0x57b2cd(0x2b2)][_0x57b2cd(0x2ce)]['toUpperCase'](),'value':''+_0x114792['toString'](),'breakdown':{'item_total':{'value':_0x114792['toString'](),'currency_code':config[_0x57b2cd(0x2b2)][_0x57b2cd(0x2ce)][_0x57b2cd(0x252)]()}}},'reference_id':'2','description':_0x57b2cd(0x302)+_0x5ae4d7[_0x57b2cd(0x1fc)][_0x57b2cd(0x324)][_0x57b2cd(0x341)]['id']+_0x57b2cd(0x2e6)+config[_0x57b2cd(0x29c)]+_0x57b2cd(0x236)}]};_0xe9a5ff[_0x57b2cd(0x226)](_0x3aa7f6);let _0x5d9404=await paypalClient[_0x57b2cd(0x1c7)](_0xe9a5ff);await dbcon[_0x57b2cd(0x299)](_0x57b2cd(0x262)+_0x24e286+'\x27,\x20\x27'+_0x5ae4d7['session'][_0x57b2cd(0x324)]['user']['id']+_0x57b2cd(0x1fa)+_0x5d9404[_0x57b2cd(0x321)]['id']+_0x57b2cd(0x240)+_0x59e674+'\x27)',async function(_0x316c9b,_0x424e9c){if(_0x316c9b)throw _0x316c9b;}),await _0x15e9dd['redirect'](_0x5d9404['result'][_0x57b2cd(0x1b5)][_0x57b2cd(0x30d)](_0x2566f7=>_0x2566f7[_0x57b2cd(0x2cb)]==_0x57b2cd(0x320))[0x0][_0x57b2cd(0x330)]);}}}),audit(_0x8334fa(0x1f0),_0x5ae4d7['session']['passport'][_0x8334fa(0x341)][_0x8334fa(0x24d)]+'\x20('+_0x5ae4d7[_0x8334fa(0x1fc)]['passport'][_0x8334fa(0x341)]['id']+_0x8334fa(0x2e1));});}async function completeCheckout(_0x4e3089,_0x2801c1){const _0x57d9db=_0x4df485;if(!_0x4e3089['params'][_0x57d9db(0x2aa)])return console[_0x57d9db(0x2a0)](_0x57d9db(0x2ba));_0x4e3089[_0x57d9db(0x203)][_0x57d9db(0x2aa)]=await utils['sanitize'](_0x4e3089[_0x57d9db(0x203)][_0x57d9db(0x2aa)]),_0x4e3089[_0x57d9db(0x203)][_0x57d9db(0x332)]=await utils['sanitize'](_0x4e3089[_0x57d9db(0x203)][_0x57d9db(0x332)]);let _0x21148e=[],_0x5ee57f=[],_0x4123ba=await utils[_0x57d9db(0x31c)](0x16);await dbcon[_0x57d9db(0x299)](_0x57d9db(0x2be)+_0x4e3089['params'][_0x57d9db(0x2aa)]+_0x57d9db(0x1b8)+_0x4e3089[_0x57d9db(0x1fc)][_0x57d9db(0x324)][_0x57d9db(0x341)]['id']+'\x22',async(_0x2f5442,_0x4d8548)=>{const _0x23a582=_0x57d9db;if(_0x2f5442)throw _0x2f5442;if(!_0x4d8548[0x0])return _0x2801c1['redirect']('/404');let _0x31ed6a=_0x4d8548[0x0];if(_0x4d8548[0x0][_0x23a582(0x2f1)]==_0x23a582(0x1c4)&&_0x4d8548[0x0][_0x23a582(0x35b)]=='0.00')try{let _0x30e38c=new PaypalImport['orders']['OrdersCaptureRequest'](_0x4d8548[0x0]['sessionid']);_0x30e38c[_0x23a582(0x226)]({});let _0x3d533a=await paypalClient[_0x23a582(0x1c7)](_0x30e38c);if(_0x3d533a?.[_0x23a582(0x327)]!=0xc9)return _0x2801c1['send']('PayPal\x20payment\x20error.\x20Declined\x20(E04)');if(_0x3d533a?.[_0x23a582(0x321)]?.[_0x23a582(0x22e)]!=_0x23a582(0x1ba))return _0x2801c1[_0x23a582(0x2b6)](_0x23a582(0x22f));}catch(_0x407a67){return config['debugMode']&&console['log'](_0x407a67),_0x2801c1[_0x23a582(0x2b6)](_0x23a582(0x212));}_0x4d8548[0x0]['leftover']!=_0x23a582(0x347)&&dbcon[_0x23a582(0x299)]('SELECT\x20*\x20FROM\x20users\x20WHERE\x20userid=\x22'+_0x4e3089[_0x23a582(0x1fc)]['passport'][_0x23a582(0x341)]['id']+'\x22',async function(_0x29e53b,_0x35822c){const _0x102b8e=_0x23a582;if(_0x29e53b)throw _0x29e53b;if(!_0x35822c[0x0])return;let _0x1ffd72=_0x35822c[0x0];dbcon[_0x102b8e(0x299)](_0x102b8e(0x251)+_0x35822c[0x0]['giftcard']+'\x22',function(_0x1f9175,_0x162969){const _0x26a97b=_0x102b8e;if(_0x1f9175)throw _0x1f9175;if(!_0x162969[0x0])return;let _0x56d0a6=Number(_0x4d8548[0x0][_0x26a97b(0x35b)])['toFixed'](0x2);_0x56d0a6=='0.00'?dbcon[_0x26a97b(0x299)](_0x26a97b(0x26c)+_0x35822c[0x0]['giftcard']+_0x26a97b(0x29f),function(_0x537c03,_0x11b6fb){if(_0x537c03)throw _0x537c03;}):dbcon[_0x26a97b(0x299)](_0x26a97b(0x300)+_0x56d0a6+'\x22\x20WHERE\x20code=\x22'+_0x35822c[0x0][_0x26a97b(0x2e0)]+'\x22',function(_0x4a6e8e,_0x15f0b1){if(_0x4a6e8e)throw _0x4a6e8e;});});});let _0x4faeaf=await utils[_0x23a582(0x271)](config[_0x23a582(0x230)]['tz'],config[_0x23a582(0x230)][_0x23a582(0x2ac)]),_0x12cc40=0x0;return await dbcon[_0x23a582(0x299)](_0x23a582(0x217)+_0x4d8548[0x0][_0x23a582(0x1f3)]+'\x22',async(_0x5f3799,_0x256a11)=>{const _0x540bff=_0x23a582;if(_0x5f3799)throw _0x5f3799;let _0x32c827=JSON[_0x540bff(0x2c5)](_0x256a11[0x0][_0x540bff(0x1df)]);for(let _0x496507 of _0x32c827){_0x256a11[0x0][_0x540bff(0x1ce)]>0x0&&(_0x496507[_0x540bff(0x34a)]=(Math['round'](0x64*(Number(_0x496507[_0x540bff(0x34a)])-Number(_0x496507[_0x540bff(0x34a)])/0xa*(_0x256a11[0x0][_0x540bff(0x1ce)]*0.1)))/0x64)['toString']());let _0x48a394=await utils['generateRandom'](0x17);await dbcon[_0x540bff(0x299)](_0x540bff(0x28d)+_0x48a394+_0x540bff(0x237)+_0x496507[_0x540bff(0x2aa)]+_0x540bff(0x237)+_0x256a11[0x0][_0x540bff(0x1f3)]+_0x540bff(0x237)+_0x496507[_0x540bff(0x221)]+_0x540bff(0x237)+_0x4faeaf+'\x22,\x20\x22'+_0x496507[_0x540bff(0x34a)]+_0x540bff(0x237)+_0x4123ba+_0x540bff(0x237)+await utils[_0x540bff(0x31c)](0x9,!![])+'_'+await utils[_0x540bff(0x31c)](0xc)+_0x540bff(0x322),async(_0x2c5682,_0x5434e5)=>{if(_0x2c5682)throw _0x2c5682;}),await dbcon[_0x540bff(0x299)](_0x540bff(0x1b2)+_0x496507[_0x540bff(0x2aa)]+'\x22',async(_0xb2f86a,_0x5b937b)=>{const _0x777fba=_0x540bff;if(_0xb2f86a)throw _0xb2f86a;if(!_0x5b937b[0x0])return;let _0x4ba34c=Number(_0x5b937b[0x0]['overallprofit']);_0x4ba34c=_0x4ba34c+Number(_0x496507[_0x777fba(0x34a)]),_0x4ba34c=Math['round'](0x64*_0x4ba34c)/0x64,_0x4ba34c=_0x4ba34c['toString'](),!_0x4ba34c[_0x777fba(0x261)]('.')&&(_0x4ba34c=_0x4ba34c+'.00'),dbcon[_0x777fba(0x299)](_0x777fba(0x22b)+_0x4ba34c+_0x777fba(0x2e7)+_0x5b937b[0x0][_0x777fba(0x2aa)]+'\x22',async(_0x2c5301,_0x495444)=>{if(_0x2c5301)throw _0x2c5301;});}),_0x21148e[_0x540bff(0x220)]({'uniqueid':_0x496507[_0x540bff(0x2aa)],'name':_0x496507[_0x540bff(0x221)],'price':_0x496507[_0x540bff(0x34a)]}),_0x5ee57f['push']('-\x20'+_0x496507['name']+'\x20('+config[_0x540bff(0x2b2)]['currencySymbol']+_0x496507[_0x540bff(0x34a)]+')'),_0x12cc40=_0x12cc40+Number(_0x496507[_0x540bff(0x34a)]),await addCustomerRoleToUser(_0x4e3089['session'][_0x540bff(0x324)][_0x540bff(0x341)]['id'],_0x496507['uniqueid'],_0x4e3089[_0x540bff(0x1fc)][_0x540bff(0x324)][_0x540bff(0x341)][_0x540bff(0x376)]);}await dbcon['query'](_0x540bff(0x23a)+_0x4123ba+_0x540bff(0x1fa)+_0x4e3089[_0x540bff(0x1fc)][_0x540bff(0x324)][_0x540bff(0x341)]['id']+_0x540bff(0x1fa)+JSON[_0x540bff(0x331)](_0x21148e)+_0x540bff(0x1fa)+_0x4e3089[_0x540bff(0x203)]['type']+_0x540bff(0x1fa)+_0x4faeaf+'\x27)',async(_0x2e014c,_0x20d2c8)=>{if(_0x2e014c)throw _0x2e014c;}),dbcon[_0x540bff(0x299)](_0x540bff(0x2fa),async(_0x3daeb1,_0x1fcb4e)=>{const _0x15c21c=_0x540bff;if(_0x3daeb1)throw _0x3daeb1;let _0x335747=Number(_0x1fcb4e[0x0]['totalincome']);_0x335747=_0x335747+_0x12cc40,_0x335747=Math[_0x15c21c(0x1cd)](0x64*_0x335747)/0x64,_0x335747=_0x335747['toString'](),!_0x335747['includes']('.')&&(_0x335747=_0x335747+_0x15c21c(0x2d9)),dbcon[_0x15c21c(0x299)](_0x15c21c(0x35a)+_0x335747+'\x22',async(_0x7c0355,_0x67c6cb)=>{if(_0x7c0355)throw _0x7c0355;});}),setTimeout(function(){const _0xe44d69=_0x540bff;createEmail(_0x256a11[0x0][_0xe44d69(0x1a0)],_0xe44d69(0x26d),'Hey\x20'+_0x256a11[0x0][_0xe44d69(0x24d)]+_0xe44d69(0x214)+_0x5ee57f[_0xe44d69(0x2e9)]('')+_0xe44d69(0x303)+config[_0xe44d69(0x29c)]+'/account\x27\x20style=\x22color:\x20white;\x20text-decoration:\x20none;\x20padding:\x200.6em;\x20font-size:\x201.4em;\x20border-radius:\x200.4em;\x20background-color:\x20'+storedAppVariable[_0xe44d69(0x2da)][_0xe44d69(0x274)]['sitecolor']+_0xe44d69(0x1e7),_0xe44d69(0x346));},0x1388);}),setTimeout(async()=>{const _0x419bb8=_0x23a582;await dbcon[_0x419bb8(0x299)](_0x419bb8(0x36d)+_0x4e3089['params'][_0x419bb8(0x2aa)]+_0x419bb8(0x1b8)+_0x4e3089[_0x419bb8(0x1fc)]['passport'][_0x419bb8(0x341)]['id']+_0x419bb8(0x29f),async(_0x3b3f1e,_0x49bf67)=>{if(_0x3b3f1e)throw _0x3b3f1e;});},0x7d0),await dbcon['query'](_0x23a582(0x270)+_0x4e3089['session'][_0x23a582(0x324)][_0x23a582(0x341)]['id']+'\x22',async(_0xcf1479,_0x2d2163)=>{if(_0xcf1479)throw _0xcf1479;}),audit(_0x23a582(0x258),_0x4e3089[_0x23a582(0x1fc)][_0x23a582(0x324)][_0x23a582(0x341)][_0x23a582(0x24d)]+'\x20('+_0x4e3089[_0x23a582(0x1fc)][_0x23a582(0x324)][_0x23a582(0x341)]['id']+_0x23a582(0x215)),_0x2801c1[_0x23a582(0x32c)](_0x23a582(0x1dc));});}async function checkoutInvoice(_0x584b5d,_0x5307a5){const _0x47c005=_0x4df485;let _0x5d0c6f=await utils['generateRandom'](0x15);_0x584b5d[_0x47c005(0x203)][_0x47c005(0x349)]=await utils[_0x47c005(0x1a2)](_0x584b5d[_0x47c005(0x203)][_0x47c005(0x349)]);if(!_0x584b5d['params'][_0x47c005(0x332)])return console[_0x47c005(0x2a0)](_0x47c005(0x360));let _0x4f4e44=0x0;await dbcon[_0x47c005(0x299)]('SELECT\x20*\x20FROM\x20invoices\x20WHERE\x20uniqueid=\x22'+_0x584b5d[_0x47c005(0x203)][_0x47c005(0x349)]+'\x22',async(_0x1e52a8,_0x4e6a16)=>{const _0xee8958=_0x47c005;if(_0x1e52a8)throw _0x1e52a8;let _0x5668cc=_0x4e6a16[0x0];if(_0x584b5d['params']['type']=='stripe'){let _0x2e7dd4;_0x4e6a16[0x0][_0xee8958(0x34a)][_0xee8958(0x1ca)]('.','')['length']<0x2&&(_0x4e6a16[0x0][_0xee8958(0x34a)]=_0x4e6a16[0x0][_0xee8958(0x34a)]+'0');_0x4e6a16[0x0]['price'][_0xee8958(0x1ca)]('.','')['length']<0x3&&(_0x4e6a16[0x0][_0xee8958(0x34a)]=_0x4e6a16[0x0][_0xee8958(0x34a)]+'0');_0x4e6a16[0x0][_0xee8958(0x34a)][_0xee8958(0x33b)]('.5')&&(_0x4e6a16[0x0]['price']=_0x4e6a16[0x0][_0xee8958(0x34a)][_0xee8958(0x204)]('.')[0x0]+_0xee8958(0x264));_0x4e6a16[0x0][_0xee8958(0x34a)]['includes']('.')?_0x2e7dd4=Number(_0x4e6a16[0x0][_0xee8958(0x34a)][_0xee8958(0x1ca)]('.','')):_0x2e7dd4=Number(_0x4e6a16[0x0][_0xee8958(0x34a)])*0x64;if(_0x2e7dd4<0.51)return _0x2e7dd4==0x0?(await dbcon[_0xee8958(0x299)](_0xee8958(0x1eb)+_0x5d0c6f+_0xee8958(0x1fa)+_0x584b5d['session'][_0xee8958(0x324)][_0xee8958(0x341)]['id']+_0xee8958(0x2fe),async function(_0x34f443,_0x938c33){if(_0x34f443)throw _0x34f443;}),audit('Checkout\x20Session\x20Created',_0x584b5d['session']['passport']['user'][_0xee8958(0x24d)]+'\x20('+_0x584b5d[_0xee8958(0x1fc)][_0xee8958(0x324)]['user']['id']+_0xee8958(0x2e1)),_0x5307a5[_0xee8958(0x32c)](_0xee8958(0x233)+_0x5d0c6f+_0xee8958(0x1f7)+_0x584b5d[_0xee8958(0x203)][_0xee8958(0x349)])):_0x5307a5[_0xee8958(0x2b6)](_0xee8958(0x1f1));let _0x21fff2=[{'price_data':{'currency':config[_0xee8958(0x2b2)][_0xee8958(0x2ce)],'product_data':{'name':_0xee8958(0x21c)+_0x584b5d['params'][_0xee8958(0x349)],'images':[config[_0xee8958(0x29c)]+'/assets/logo.png']},'unit_amount':_0x2e7dd4},'quantity':0x1}];await dbcon['query'](_0xee8958(0x30e)+_0x584b5d[_0xee8958(0x1fc)][_0xee8958(0x324)]['user']['id']+'\x27',async function(_0x8448df,_0x11af20){const _0x15c185=_0xee8958;if(_0x8448df)throw _0x8448df;const _0x331f0a=await stripe[_0x15c185(0x30b)][_0x15c185(0x31f)][_0x15c185(0x2a5)]({'line_items':_0x21fff2,'mode':_0x15c185(0x2bc),'allow_promotion_codes':![],'success_url':config[_0x15c185(0x29c)]+_0x15c185(0x233)+_0x5d0c6f+_0x15c185(0x1f7)+_0x584b5d[_0x15c185(0x203)][_0x15c185(0x349)],'cancel_url':config[_0x15c185(0x29c)]+_0x15c185(0x24a)+_0x584b5d[_0x15c185(0x203)][_0x15c185(0x349)]});await dbcon['query'](_0x15c185(0x1eb)+_0x5d0c6f+_0x15c185(0x1fa)+_0x584b5d[_0x15c185(0x1fc)][_0x15c185(0x324)][_0x15c185(0x341)]['id']+_0x15c185(0x1fa)+_0x331f0a['id']+_0x15c185(0x312),async function(_0x2a129d,_0x2d8264){if(_0x2a129d)throw _0x2a129d;}),await _0x5307a5[_0x15c185(0x32c)](_0x331f0a[_0x15c185(0x32b)]),audit(_0x15c185(0x19f),_0x584b5d[_0x15c185(0x1fc)][_0x15c185(0x324)][_0x15c185(0x341)][_0x15c185(0x24d)]+'\x20('+_0x584b5d['session'][_0x15c185(0x324)]['user']['id']+_0x15c185(0x1ef));});}else{if(_0x584b5d['params'][_0xee8958(0x332)]==_0xee8958(0x1b9)){let _0x38c770=Number(_0x4e6a16[0x0]['price']);_0x4f4e44=_0x4f4e44+Number(_0x38c770['toFixed'](0x2));let _0x167189=[{'name':_0x4e6a16[0x0][_0xee8958(0x279)],'unit_amount':{'currency_code':config['paymentSettings'][_0xee8958(0x2ce)][_0xee8958(0x252)](),'value':''+_0x38c770[_0xee8958(0x281)](0x2)},'quantity':'1'}];if(_0x4f4e44==0x0)return await dbcon['query'](_0xee8958(0x1eb)+_0x5d0c6f+_0xee8958(0x1fa)+_0x584b5d[_0xee8958(0x1fc)][_0xee8958(0x324)][_0xee8958(0x341)]['id']+'\x27,\x20\x27NO_VALUE_100_DISCOUNT\x27,\x20\x27PayPal\x27)',async function(_0x136816,_0x5a201d){if(_0x136816)throw _0x136816;}),audit(_0xee8958(0x1f0),_0x584b5d[_0xee8958(0x1fc)]['passport']['user']['username']+'\x20('+_0x584b5d['session']['passport'][_0xee8958(0x341)]['id']+_0xee8958(0x2e1)),_0x5307a5[_0xee8958(0x32c)](_0xee8958(0x23f)+_0x5d0c6f+'/paypal');let _0xf8d6f3=new PaypalImport[(_0xee8958(0x288))][(_0xee8958(0x334))](),_0x20e156={'intent':_0xee8958(0x1aa),'application_context':{'return_url':config[_0xee8958(0x29c)]+_0xee8958(0x233)+_0x5d0c6f+_0xee8958(0x28e)+_0x4e6a16[0x0][_0xee8958(0x2aa)],'cancel_url':config['domain']+_0xee8958(0x335),'brand_name':''+storedAppVariable[_0xee8958(0x2da)][_0xee8958(0x274)][_0xee8958(0x2fc)],'user_action':_0xee8958(0x1e0)},'purchase_units':[{'items':_0x167189,'amount':{'currency_code':config[_0xee8958(0x2b2)]['currency'][_0xee8958(0x252)](),'value':''+_0x4f4e44[_0xee8958(0x371)](),'breakdown':{'item_total':{'value':_0x4f4e44[_0xee8958(0x371)](),'currency_code':config[_0xee8958(0x2b2)][_0xee8958(0x2ce)]['toUpperCase']()}}},'reference_id':'2','description':'Invoice:\x20'+_0x4e6a16[0x0][_0xee8958(0x2aa)]+'\x20Account:\x20'+_0x584b5d[_0xee8958(0x1fc)][_0xee8958(0x324)]['user']['id']+_0xee8958(0x337)+config['domain']+'/tos'}]};_0xf8d6f3[_0xee8958(0x226)](_0x20e156);let _0x2d3caf=await paypalClient[_0xee8958(0x1c7)](_0xf8d6f3);await _0x5307a5[_0xee8958(0x32c)](_0x2d3caf[_0xee8958(0x321)][_0xee8958(0x1b5)][_0xee8958(0x30d)](_0x36a994=>_0x36a994[_0xee8958(0x2cb)]=='approve')[0x0][_0xee8958(0x330)]),await dbcon['query'](_0xee8958(0x1eb)+_0x5d0c6f+'\x27,\x20\x27'+_0x584b5d[_0xee8958(0x1fc)][_0xee8958(0x324)][_0xee8958(0x341)]['id']+'\x27,\x20\x27'+_0x2d3caf['result']['id']+_0xee8958(0x25d),async function(_0x175ead,_0xe93930){if(_0x175ead)throw _0x175ead;});}}});}async function completeCheckoutInvoice(_0x2bdfe7,_0x2db3bf){const _0x21361f=_0x4df485;if(!_0x2bdfe7[_0x21361f(0x203)]['uniqueid'])return console['log'](_0x21361f(0x1fb));_0x2bdfe7['params'][_0x21361f(0x2aa)]=await utils[_0x21361f(0x1a2)](_0x2bdfe7[_0x21361f(0x203)]['uniqueid']),_0x2bdfe7[_0x21361f(0x203)][_0x21361f(0x332)]=await utils[_0x21361f(0x1a2)](_0x2bdfe7['params'][_0x21361f(0x332)]),_0x2bdfe7['params'][_0x21361f(0x349)]=await utils[_0x21361f(0x1a2)](_0x2bdfe7[_0x21361f(0x203)][_0x21361f(0x349)]),await dbcon['query'](_0x21361f(0x2be)+_0x2bdfe7['params'][_0x21361f(0x2aa)]+_0x21361f(0x1b8)+_0x2bdfe7[_0x21361f(0x1fc)][_0x21361f(0x324)][_0x21361f(0x341)]['id']+'\x22',async(_0x4ec644,_0x3acbb5)=>{const _0xdcdc9e=_0x21361f;if(_0x4ec644)throw _0x4ec644;if(!_0x3acbb5[0x0])return _0x2db3bf[_0xdcdc9e(0x32c)](_0xdcdc9e(0x22c));if(_0x3acbb5[0x0][_0xdcdc9e(0x2f1)]=='PayPal')try{let _0x4bdee1=new PaypalImport[(_0xdcdc9e(0x288))][(_0xdcdc9e(0x2b5))](_0x3acbb5[0x0][_0xdcdc9e(0x2ad)]);_0x4bdee1['requestBody']({});let _0xb57325=await paypalClient['execute'](_0x4bdee1);if(_0xb57325?.[_0xdcdc9e(0x327)]!=0xc9)return _0x2db3bf[_0xdcdc9e(0x2b6)]('PayPal\x20payment\x20error.\x20Declined\x20(E04)');if(_0xb57325?.[_0xdcdc9e(0x321)]?.[_0xdcdc9e(0x22e)]!=_0xdcdc9e(0x1ba))return _0x2db3bf[_0xdcdc9e(0x2b6)]('PayPal\x20payment\x20error\x20(E02).');}catch(_0xbe732){return config[_0xdcdc9e(0x34b)]&&console[_0xdcdc9e(0x2a0)](_0xbe732),_0x2db3bf[_0xdcdc9e(0x2b6)](_0xdcdc9e(0x212));}return await dbcon['query'](_0xdcdc9e(0x36d)+_0x2bdfe7[_0xdcdc9e(0x203)][_0xdcdc9e(0x2aa)]+_0xdcdc9e(0x1b8)+_0x2bdfe7[_0xdcdc9e(0x1fc)][_0xdcdc9e(0x324)]['user']['id']+_0xdcdc9e(0x29f),async(_0x41ba4c,_0x4cbb69)=>{if(_0x41ba4c)throw _0x41ba4c;}),await dbcon[_0xdcdc9e(0x299)](_0xdcdc9e(0x373)+_0x2bdfe7[_0xdcdc9e(0x1fc)][_0xdcdc9e(0x324)][_0xdcdc9e(0x341)]['id']+'\x22',async(_0x56312f,_0x509586)=>{if(_0x56312f)throw _0x56312f;}),await dbcon[_0xdcdc9e(0x299)]('UPDATE\x20invoices\x20SET\x20paid=true\x20WHERE\x20uniqueid=\x22'+_0x2bdfe7[_0xdcdc9e(0x203)]['invoiceid']+'\x22',async(_0x21c75d,_0x26a564)=>{if(_0x21c75d)throw _0x21c75d;}),await dbcon['query'](_0xdcdc9e(0x1c6)+_0x2bdfe7['params'][_0xdcdc9e(0x349)]+'\x22',async(_0x139519,_0x4507fe)=>{const _0x3b61ce=_0xdcdc9e;if(_0x139519)throw _0x139519;let _0x3e42b6=Number(_0x4507fe[0x0][_0x3b61ce(0x34a)]);dbcon['query'](_0x3b61ce(0x2fa),async(_0x5ac8ac,_0x2a109d)=>{const _0x20a104=_0x3b61ce;if(_0x5ac8ac)throw _0x5ac8ac;let _0x35b94d=Number(_0x2a109d[0x0]['totalincome']);_0x35b94d=_0x35b94d+_0x3e42b6,_0x35b94d=Math[_0x20a104(0x1cd)](0x64*_0x35b94d)/0x64,_0x35b94d=_0x35b94d[_0x20a104(0x371)](),!_0x35b94d[_0x20a104(0x261)]('.')&&(_0x35b94d=_0x35b94d+_0x20a104(0x2d9)),dbcon[_0x20a104(0x299)](_0x20a104(0x35a)+_0x35b94d+'\x22',async(_0x50d6ab,_0x92c789)=>{if(_0x50d6ab)throw _0x50d6ab;});});}),audit(_0xdcdc9e(0x201),_0x2bdfe7[_0xdcdc9e(0x1fc)][_0xdcdc9e(0x324)][_0xdcdc9e(0x341)][_0xdcdc9e(0x24d)]+'\x20('+_0x2bdfe7['session']['passport']['user']['id']+_0xdcdc9e(0x356)),_0x2db3bf[_0xdcdc9e(0x32c)](_0xdcdc9e(0x24a)+_0x2bdfe7['params'][_0xdcdc9e(0x349)]);});}async function checkoutGiftcard(_0x1d6de4,_0x15744f){const _0x2c2fd2=_0x4df485;let _0x8c1cd0=await utils['generateRandom'](0x15);_0x1d6de4['params'][_0x2c2fd2(0x2d3)]=await utils['sanitize'](_0x1d6de4[_0x2c2fd2(0x203)][_0x2c2fd2(0x2d3)]);if(!_0x1d6de4[_0x2c2fd2(0x203)]['type'])return console[_0x2c2fd2(0x2a0)](_0x2c2fd2(0x360));let _0x5d750b=0x0;await dbcon[_0x2c2fd2(0x299)](_0x2c2fd2(0x26f)+_0x1d6de4[_0x2c2fd2(0x203)][_0x2c2fd2(0x2d3)]+'\x22',async(_0x9da655,_0x2aacf5)=>{const _0x998d12=_0x2c2fd2;if(_0x9da655)throw _0x9da655;let _0x2ddfe1=_0x2aacf5[0x0];if(_0x1d6de4['params'][_0x998d12(0x332)]=='stripe'){let _0x4dabc0;_0x2aacf5[0x0][_0x998d12(0x1a6)][_0x998d12(0x1ca)]('.','')[_0x998d12(0x21e)]<0x2&&(_0x2aacf5[0x0][_0x998d12(0x1a6)]=_0x2aacf5[0x0][_0x998d12(0x1a6)]+'0');_0x2aacf5[0x0][_0x998d12(0x1a6)][_0x998d12(0x1ca)]('.','')[_0x998d12(0x21e)]<0x3&&(_0x2aacf5[0x0]['amount']=_0x2aacf5[0x0][_0x998d12(0x1a6)]+'0');_0x2aacf5[0x0][_0x998d12(0x1a6)][_0x998d12(0x33b)]('.5')&&(_0x2aacf5[0x0][_0x998d12(0x1a6)]=_0x2aacf5[0x0]['amount']['split']('.')[0x0]+_0x998d12(0x264));_0x2aacf5[0x0][_0x998d12(0x1a6)]['includes']('.')?_0x4dabc0=Number(_0x2aacf5[0x0][_0x998d12(0x1a6)][_0x998d12(0x1ca)]('.','')):_0x4dabc0=Number(_0x2aacf5[0x0][_0x998d12(0x1a6)])*0x64;if(_0x4dabc0<0.51)return _0x4dabc0==0x0?(await dbcon['query']('INSERT\x20INTO\x20pendingpurchases\x20(uniqueid,\x20userid,\x20sessionid,\x20paymenttype)\x20VALUES\x20(\x27'+_0x8c1cd0+_0x998d12(0x1fa)+_0x1d6de4[_0x998d12(0x1fc)]['passport'][_0x998d12(0x341)]['id']+'\x27,\x20\x27NO_VALUE_100_DISCOUNT_GIFTCARD\x27,\x20\x27Stripe\x27)',async function(_0x4bdfcc,_0x331476){if(_0x4bdfcc)throw _0x4bdfcc;}),audit(_0x998d12(0x1f0),_0x1d6de4['session'][_0x998d12(0x324)]['user'][_0x998d12(0x24d)]+'\x20('+_0x1d6de4['session']['passport'][_0x998d12(0x341)]['id']+_0x998d12(0x2e1)),_0x15744f[_0x998d12(0x32c)]('/backend/finishcheckoutgiftcard/'+_0x8c1cd0+'/stripe/'+_0x1d6de4[_0x998d12(0x203)][_0x998d12(0x2d3)])):_0x15744f[_0x998d12(0x2b6)](_0x998d12(0x1f1));let _0x5bc706=[{'price_data':{'currency':config[_0x998d12(0x2b2)][_0x998d12(0x2ce)],'product_data':{'name':''+_0x2aacf5[0x0][_0x998d12(0x221)],'images':[config[_0x998d12(0x29c)]+'/images/giftcard_'+_0x2aacf5[0x0][_0x998d12(0x2aa)]+_0x998d12(0x291)]},'unit_amount':_0x4dabc0},'quantity':0x1}];await dbcon[_0x998d12(0x299)](_0x998d12(0x30e)+_0x1d6de4[_0x998d12(0x1fc)]['passport']['user']['id']+'\x27',async function(_0x11c4bc,_0x4900a6){const _0xbbe242=_0x998d12;if(_0x11c4bc)throw _0x11c4bc;const _0x2bc36a=await stripe[_0xbbe242(0x30b)][_0xbbe242(0x31f)]['create']({'line_items':_0x5bc706,'mode':_0xbbe242(0x2bc),'allow_promotion_codes':![],'success_url':config[_0xbbe242(0x29c)]+_0xbbe242(0x2a7)+_0x8c1cd0+_0xbbe242(0x1f7)+_0x1d6de4[_0xbbe242(0x203)][_0xbbe242(0x2d3)],'cancel_url':config[_0xbbe242(0x29c)]+_0xbbe242(0x267)});await dbcon['query'](_0xbbe242(0x1eb)+_0x8c1cd0+_0xbbe242(0x1fa)+_0x1d6de4[_0xbbe242(0x1fc)]['passport'][_0xbbe242(0x341)]['id']+_0xbbe242(0x1fa)+_0x2bc36a['id']+_0xbbe242(0x312),async function(_0x8ef4fd,_0x4ed446){if(_0x8ef4fd)throw _0x8ef4fd;}),await _0x15744f[_0xbbe242(0x32c)](_0x2bc36a[_0xbbe242(0x32b)]),audit(_0xbbe242(0x244),_0x1d6de4[_0xbbe242(0x1fc)][_0xbbe242(0x324)]['user']['username']+'\x20('+_0x1d6de4[_0xbbe242(0x1fc)][_0xbbe242(0x324)][_0xbbe242(0x341)]['id']+_0xbbe242(0x225));});}else{if(_0x1d6de4[_0x998d12(0x203)]['type']=='paypal'){let _0x2d24c8=Number(_0x2aacf5[0x0]['amount']);_0x5d750b=_0x5d750b+Number(_0x2d24c8[_0x998d12(0x281)](0x2));let _0x5cf519=[{'name':_0x2aacf5[0x0][_0x998d12(0x221)],'unit_amount':{'currency_code':config[_0x998d12(0x2b2)][_0x998d12(0x2ce)][_0x998d12(0x252)](),'value':''+_0x2d24c8['toFixed'](0x2)},'quantity':'1'}];if(_0x5d750b==0x0)return await dbcon[_0x998d12(0x299)](_0x998d12(0x1eb)+_0x8c1cd0+_0x998d12(0x1fa)+_0x1d6de4[_0x998d12(0x1fc)][_0x998d12(0x324)][_0x998d12(0x341)]['id']+_0x998d12(0x2c7),async function(_0x1b18c1,_0xe7d8c2){if(_0x1b18c1)throw _0x1b18c1;}),audit(_0x998d12(0x1f0),_0x1d6de4[_0x998d12(0x1fc)]['passport']['user'][_0x998d12(0x24d)]+'\x20('+_0x1d6de4[_0x998d12(0x1fc)][_0x998d12(0x324)]['user']['id']+_0x998d12(0x2e1)),_0x15744f[_0x998d12(0x32c)](_0x998d12(0x2a7)+_0x8c1cd0+_0x998d12(0x232));let _0x1f5007=new PaypalImport[(_0x998d12(0x288))]['OrdersCreateRequest'](),_0x2854ec={'intent':_0x998d12(0x1aa),'application_context':{'return_url':config[_0x998d12(0x29c)]+_0x998d12(0x2a7)+_0x8c1cd0+_0x998d12(0x28e)+_0x2aacf5[0x0]['uniqueid'],'cancel_url':config['domain']+_0x998d12(0x335),'brand_name':''+storedAppVariable['locals']['sitesettings'][_0x998d12(0x2fc)],'user_action':_0x998d12(0x1e0)},'purchase_units':[{'items':_0x5cf519,'amount':{'currency_code':config['paymentSettings']['currency'][_0x998d12(0x252)](),'value':''+_0x5d750b[_0x998d12(0x371)](),'breakdown':{'item_total':{'value':_0x5d750b[_0x998d12(0x371)](),'currency_code':config[_0x998d12(0x2b2)][_0x998d12(0x2ce)][_0x998d12(0x252)]()}}},'reference_id':'2','description':_0x998d12(0x1b3)+_0x2aacf5[0x0][_0x998d12(0x2aa)]+_0x998d12(0x318)+_0x1d6de4[_0x998d12(0x1fc)]['passport']['user']['id']+_0x998d12(0x337)+config[_0x998d12(0x29c)]+'/tos'}]};_0x1f5007[_0x998d12(0x226)](_0x2854ec);let _0x2479a1=await paypalClient[_0x998d12(0x1c7)](_0x1f5007);await _0x15744f[_0x998d12(0x32c)](_0x2479a1[_0x998d12(0x321)][_0x998d12(0x1b5)]['filter'](_0x5bce60=>_0x5bce60[_0x998d12(0x2cb)]==_0x998d12(0x320))[0x0][_0x998d12(0x330)]),await dbcon[_0x998d12(0x299)]('INSERT\x20INTO\x20pendingpurchases\x20(uniqueid,\x20userid,\x20sessionid,\x20paymenttype)\x20VALUES\x20(\x27'+_0x8c1cd0+_0x998d12(0x1fa)+_0x1d6de4[_0x998d12(0x1fc)][_0x998d12(0x324)][_0x998d12(0x341)]['id']+_0x998d12(0x1fa)+_0x2479a1[_0x998d12(0x321)]['id']+'\x27,\x20\x27PayPal\x27)',async function(_0xa9a5cf,_0x24e516){if(_0xa9a5cf)throw _0xa9a5cf;});}}});}async function completeCheckoutGiftcard(_0x3947ec,_0x740ef4){const _0x534c2e=_0x4df485;if(!_0x3947ec[_0x534c2e(0x203)][_0x534c2e(0x2aa)])return console[_0x534c2e(0x2a0)]('No\x20uniqueid\x20in\x20giftcard\x20completion\x20ticket\x20after\x20payment.');_0x3947ec[_0x534c2e(0x203)][_0x534c2e(0x2aa)]=await utils[_0x534c2e(0x1a2)](_0x3947ec[_0x534c2e(0x203)][_0x534c2e(0x2aa)]),_0x3947ec['params'][_0x534c2e(0x332)]=await utils['sanitize'](_0x3947ec[_0x534c2e(0x203)][_0x534c2e(0x332)]),_0x3947ec[_0x534c2e(0x203)][_0x534c2e(0x2d3)]=await utils[_0x534c2e(0x1a2)](_0x3947ec['params'][_0x534c2e(0x2d3)]),await dbcon['query']('SELECT\x20*\x20FROM\x20pendingpurchases\x20WHERE\x20uniqueid=\x22'+_0x3947ec[_0x534c2e(0x203)][_0x534c2e(0x2aa)]+'\x22\x20AND\x20userid=\x22'+_0x3947ec[_0x534c2e(0x1fc)][_0x534c2e(0x324)]['user']['id']+'\x22',async(_0x4f1ece,_0x374069)=>{const _0x112587=_0x534c2e;if(_0x4f1ece)throw _0x4f1ece;if(!_0x374069[0x0])return _0x740ef4[_0x112587(0x32c)]('/404');if(_0x374069[0x0][_0x112587(0x2f1)]==_0x112587(0x1c4))try{let _0x3df7c4=new PaypalImport[(_0x112587(0x288))]['OrdersCaptureRequest'](_0x374069[0x0][_0x112587(0x2ad)]);_0x3df7c4['requestBody']({});let _0x1e6502=await paypalClient[_0x112587(0x1c7)](_0x3df7c4);if(_0x1e6502?.[_0x112587(0x327)]!=0xc9)return _0x740ef4[_0x112587(0x2b6)](_0x112587(0x314));if(_0x1e6502?.[_0x112587(0x321)]?.[_0x112587(0x22e)]!='COMPLETED')return _0x740ef4[_0x112587(0x2b6)](_0x112587(0x22f));}catch(_0xbefa5d){return config[_0x112587(0x34b)]&&console['log'](_0xbefa5d),_0x740ef4['send'](_0x112587(0x212));}return await dbcon[_0x112587(0x299)](_0x112587(0x36d)+_0x3947ec[_0x112587(0x203)][_0x112587(0x2aa)]+_0x112587(0x1b8)+_0x3947ec[_0x112587(0x1fc)][_0x112587(0x324)][_0x112587(0x341)]['id']+_0x112587(0x29f),async(_0x15a3f9,_0x4c3ed2)=>{if(_0x15a3f9)throw _0x15a3f9;}),await dbcon[_0x112587(0x299)](_0x112587(0x373)+_0x3947ec[_0x112587(0x1fc)][_0x112587(0x324)][_0x112587(0x341)]['id']+'\x22',async(_0x1a6bc1,_0x3832a8)=>{if(_0x1a6bc1)throw _0x1a6bc1;}),await dbcon['query'](_0x112587(0x26f)+_0x3947ec[_0x112587(0x203)]['giftcardid']+'\x22',async(_0x21ef04,_0xae0ee1)=>{const _0x4983a2=_0x112587;if(_0x21ef04)throw _0x21ef04;dbcon['query'](_0x4983a2(0x33e)+await utils[_0x4983a2(0x31c)](0x24)+_0x4983a2(0x237)+_0x3947ec[_0x4983a2(0x203)]['giftcardid']+_0x4983a2(0x237)+await utils['generateRandom'](0x22)+_0x4983a2(0x237)+_0xae0ee1[0x0][_0x4983a2(0x1a6)]+'\x22,\x20\x22'+_0x3947ec['session'][_0x4983a2(0x324)][_0x4983a2(0x341)]['id']+'\x22)',function(_0x54b298,_0x15ce13){if(_0x54b298)throw _0x54b298;});let _0x23006d=Number(_0xae0ee1[0x0][_0x4983a2(0x1a6)]);dbcon['query'](_0x4983a2(0x2fa),async(_0x12564d,_0x14ece8)=>{const _0xbf38f5=_0x4983a2;if(_0x12564d)throw _0x12564d;let _0x28bee8=Number(_0x14ece8[0x0][_0xbf38f5(0x2cd)]);_0x28bee8=_0x28bee8+_0x23006d,_0x28bee8=Math[_0xbf38f5(0x1cd)](0x64*_0x28bee8)/0x64,_0x28bee8=_0x28bee8['toString'](),!_0x28bee8[_0xbf38f5(0x261)]('.')&&(_0x28bee8=_0x28bee8+_0xbf38f5(0x2d9)),dbcon[_0xbf38f5(0x299)](_0xbf38f5(0x35a)+_0x28bee8+'\x22',async(_0x584634,_0x227534)=>{if(_0x584634)throw _0x584634;});});}),audit(_0x112587(0x27a),_0x3947ec[_0x112587(0x1fc)][_0x112587(0x324)][_0x112587(0x341)]['username']+'\x20('+_0x3947ec[_0x112587(0x1fc)][_0x112587(0x324)][_0x112587(0x341)]['id']+')\x20completed\x20their\x20checkout\x20session\x20for\x20their\x20giftcard.'),_0x740ef4[_0x112587(0x32c)](_0x112587(0x317)+_0x3947ec['session']['passport'][_0x112587(0x341)]['id']);});}async function checkRoleRequirements(_0x2df770,_0x3165dc){const _0x47c135=_0x4df485;if(_0x2df770[_0x47c135(0x2fd)]==_0x47c135(0x22d))return!![];let _0x16d0f9=await client[_0x47c135(0x266)][_0x47c135(0x30c)][_0x47c135(0x1d0)](storedAppVariable['locals'][_0x47c135(0x274)]['guildid']);if(!_0x16d0f9)return![];let _0x31c7fa=await _0x16d0f9[_0x47c135(0x31d)][_0x47c135(0x30c)][_0x47c135(0x1d0)](_0x3165dc['id']);if(!_0x31c7fa)return![];let _0x503b45=![],_0x4add4a=_0x2df770[_0x47c135(0x2fd)][_0x47c135(0x2ea)]('\x20','')[_0x47c135(0x204)](',');for(let _0x2782fd of _0x4add4a){await _0x31c7fa[_0x47c135(0x1a4)]['cache'][_0x47c135(0x2d4)](_0x2782fd)&&(_0x503b45=!![]);}return _0x503b45;}function findMe(_0xc2e2a2){const _0x1dc621=_0x4df485;return _0xc2e2a2['name']===require(_0x1dc621(0x1fe))[_0x1dc621(0x221)];}async function faxstoreMigration(_0x216010,_0x338c3a){const _0x5632fb=_0x4df485;let _0x850b3c={'host':_0x216010[_0x5632fb(0x20d)][_0x5632fb(0x268)],'port':_0x216010[_0x5632fb(0x20d)][_0x5632fb(0x200)],'user':_0x216010['body'][_0x5632fb(0x307)],'password':_0x216010[_0x5632fb(0x20d)][_0x5632fb(0x20e)],'database':_0x216010[_0x5632fb(0x20d)][_0x5632fb(0x2a2)]},_0x20abf5=mysql[_0x5632fb(0x366)](_0x850b3c);await _0x20abf5[_0x5632fb(0x299)](_0x5632fb(0x2eb),async function(_0x317df8,_0x464e49){const _0x22a8d2=_0x5632fb;if(_0x317df8)return _0x338c3a[_0x22a8d2(0x2b6)](_0x22a8d2(0x2e8));await backend[_0x22a8d2(0x350)](_0x22a8d2(0x355),_0x22a8d2(0x338)+_0x216010['session'][_0x22a8d2(0x324)][_0x22a8d2(0x341)][_0x22a8d2(0x24d)]+'\x20('+_0x216010['session']['passport'][_0x22a8d2(0x341)]['id']+_0x22a8d2(0x34c)),await utils[_0x22a8d2(0x32e)](_0x216010[_0x22a8d2(0x20d)]['faxdomain']+_0x22a8d2(0x29b),_0x22a8d2(0x1d6),'png',_0x22a8d2(0x33a),![]);let _0x39b92d;await _0x20abf5[_0x22a8d2(0x299)]('SELECT\x20*\x20FROM\x20sitesettings',async(_0x335378,_0x156629)=>{const _0x71b268=_0x22a8d2;if(_0x335378)throw _0x335378;_0x156629=_0x156629[0x0],_0x39b92d=_0x156629[_0x71b268(0x372)],await dbcon['query'](_0x71b268(0x1c2)+await utils[_0x71b268(0x1a2)](_0x156629['sitename'])+'\x22,\x20sitedesc=\x22'+await utils[_0x71b268(0x1a2)](_0x156629[_0x71b268(0x1c1)],!![])+_0x71b268(0x339)+_0x156629[_0x71b268(0x372)]+'\x22,\x20notification=\x22'+await utils[_0x71b268(0x1a2)](_0x71b268(0x22d),!![])+_0x71b268(0x2f4)+await utils[_0x71b268(0x1a2)](_0x156629[_0x71b268(0x1c1)],!![])+_0x71b268(0x2ca)+await utils[_0x71b268(0x1a2)](_0x156629[_0x71b268(0x1f9)],!![])+_0x71b268(0x286)+_0x156629[_0x71b268(0x287)]+_0x71b268(0x1af)+_0x156629['globalCustomerRole']+'\x22',async(_0x3cdc77,_0x626685)=>{if(_0x3cdc77)throw _0x3cdc77;}),await backend['resetAppLocals'](app);});let _0x37f19f=[];await _0x20abf5[_0x22a8d2(0x299)](_0x22a8d2(0x36c),async(_0x1e2424,_0x2a99c5)=>{if(_0x1e2424)throw _0x1e2424;await _0x2a99c5['forEach'](async function(_0x478596){const _0x52c2a1=_0x5430;if(_0x478596['title'][_0x52c2a1(0x1c5)]()[_0x52c2a1(0x2ea)]('\x20','')[_0x52c2a1(0x261)](_0x52c2a1(0x2e0)))return;if(_0x478596[_0x52c2a1(0x249)]!=0x1)return;let _0x5c14c2=await utils[_0x52c2a1(0x31c)](0xe);_0x37f19f[_0x52c2a1(0x220)]({'name':_0x478596[_0x52c2a1(0x279)],'uniqueid':_0x5c14c2,'faxstoreid':_0x478596['id']}),await _0x20abf5[_0x52c2a1(0x299)]('SELECT\x20*\x20FROM\x20productDownloads\x20WHERE\x20productId='+_0x478596['id'],async(_0x53094f,_0x274e31)=>{const _0x3e2138=_0x52c2a1;if(_0x53094f)throw _0x53094f;let _0x389f7b='zip';_0x274e31[0x0]?.[_0x3e2138(0x210)]?.[_0x3e2138(0x33b)](_0x3e2138(0x1f8))&&(_0x389f7b=_0x3e2138(0x284));_0x274e31[0x0]?.[_0x3e2138(0x210)]?.[_0x3e2138(0x33b)]('.7z')&&(_0x389f7b='7z');let _0x4b0374=await utils[_0x3e2138(0x1a2)](_0x478596['title'][_0x3e2138(0x2ea)]('\x20','')[_0x3e2138(0x2ea)]('-','')[_0x3e2138(0x2ea)](',','')['toLowerCase']()+'_'+_0x5c14c2+'.'+_0x389f7b);await dbcon['query'](_0x3e2138(0x260)+_0x5c14c2+'\x22,\x20\x22'+await utils['sanitize'](_0x478596[_0x3e2138(0x279)])+_0x3e2138(0x237)+await utils[_0x3e2138(0x1a2)](_0x478596['urlId'])+'\x22,\x20\x22'+await utils[_0x3e2138(0x1a2)](_0x478596[_0x3e2138(0x2c8)],!![])+'\x22,\x20\x22'+await utils[_0x3e2138(0x1a2)](_0x478596[_0x3e2138(0x1e3)],!![])+'\x22,\x20\x22'+await utils[_0x3e2138(0x1a2)](_0x478596[_0x3e2138(0x34a)])+'\x22,\x20\x22'+await utils['sanitize'](_0x478596['galleryImages'])+_0x3e2138(0x237)+_0x478596[_0x3e2138(0x352)]+_0x3e2138(0x237)+_0x4b0374+_0x3e2138(0x237)+(_0x478596[_0x3e2138(0x255)]||'none')+'\x22)',async(_0x27e6a8,_0x4d6ddc)=>{if(_0x27e6a8)throw _0x27e6a8;}),await utils['saveFile'](''+_0x216010[_0x3e2138(0x20d)][_0x3e2138(0x218)]+_0x478596['featureImage'],_0x3e2138(0x238)+_0x5c14c2,''+_0x478596['featureImage']['split']('.')[_0x3e2138(0x29a)]()[0x0],_0x3e2138(0x2cc),![]);});});}),setTimeout(()=>{const _0x44951f=_0x22a8d2;_0x338c3a[_0x44951f(0x211)](_0x44951f(0x333),{'shopItems':_0x37f19f,'siteColor':_0x39b92d});},0xbb8),await _0x20abf5['query']('SELECT\x20*\x20FROM\x20itemsOwned',async(_0x265a75,_0x1f6ff5)=>{const _0x15e0dd=_0x22a8d2;if(_0x265a75)throw _0x265a75;await _0x1f6ff5[_0x15e0dd(0x32a)](async function(_0x2b82f4){const _0x5ab9a1=_0x15e0dd;let _0x187ce2=await _0x37f19f['filter'](_0x47f317=>_0x47f317[_0x5ab9a1(0x25f)]==_0x2b82f4['productId']),_0x202c33=await utils['generateRandom'](0x17),_0x529a7d=new Date(_0x2b82f4[_0x5ab9a1(0x2af)]);typeof _0x187ce2[0x0]!=_0x5ab9a1(0x362)&&_0x187ce2[0x0]&&await dbcon[_0x5ab9a1(0x299)]('INSERT\x20INTO\x20owneditems\x20(uniqueid,\x20productid,\x20userid,\x20productname,\x20datebought,\x20price,\x20receipt,\x20licensekey,\x20disabled,\x20admindisabled,\x20downloads)\x20VALUES\x20(\x22'+_0x202c33+'\x22,\x20\x22'+_0x187ce2[0x0][_0x5ab9a1(0x2aa)]+_0x5ab9a1(0x237)+_0x2b82f4[_0x5ab9a1(0x25a)]+'\x22,\x20\x22'+_0x2b82f4[_0x5ab9a1(0x2b0)]+'\x22,\x20\x22'+_0x529a7d+_0x5ab9a1(0x237)+_0x2b82f4[_0x5ab9a1(0x1f4)]+_0x5ab9a1(0x329)+await utils[_0x5ab9a1(0x31c)](0x9)+'_'+await utils[_0x5ab9a1(0x31c)](0xc)+'\x22,\x20false,\x20false,\x200)',async(_0xcbca75,_0x228905)=>{if(_0xcbca75)throw _0xcbca75;});});}),await _0x20abf5[_0x22a8d2(0x299)](_0x22a8d2(0x2dc),async(_0x1fef3f,_0x53f496)=>{const _0x543b17=_0x22a8d2;if(_0x1fef3f)throw _0x1fef3f;await _0x53f496[_0x543b17(0x32a)](async function(_0x4bbf0c){const _0x2687e5=_0x543b17;await dbcon[_0x2687e5(0x299)](_0x2687e5(0x217)+_0x4bbf0c['userId']+'\x22',async(_0x49c070,_0x26b041)=>{const _0x4b6492=_0x2687e5;if(_0x49c070)throw _0x49c070;!_0x26b041[0x0]&&await dbcon[_0x4b6492(0x299)](_0x4b6492(0x342)+_0x4bbf0c[_0x4b6492(0x25a)]+'\x22',async(_0x2d7d55,_0x4d3199)=>{const _0x3eb941=_0x4b6492;if(_0x2d7d55)throw _0x2d7d55;let _0x340bad;_0x4d3199[0x0]?_0x340bad=!![]:_0x340bad=![],await dbcon[_0x3eb941(0x299)](_0x3eb941(0x298)+_0x4bbf0c[_0x3eb941(0x25a)]+'\x27,\x20\x27'+await utils[_0x3eb941(0x1a2)](_0x4bbf0c[_0x3eb941(0x2f0)])+_0x3eb941(0x1fa)+await utils[_0x3eb941(0x1a2)](_0x4bbf0c[_0x3eb941(0x24d)])+_0x3eb941(0x1fa)+_0x4bbf0c['ip']+_0x3eb941(0x2d2)+(await utils['sanitize'](_0x4bbf0c[_0x3eb941(0x309)])||'none')+_0x3eb941(0x28b)+(_0x340bad||![])+_0x3eb941(0x353),async(_0x14b87a,_0x51df84)=>{if(_0x14b87a)throw _0x14b87a;}),await utils[_0x3eb941(0x32e)](''+_0x216010[_0x3eb941(0x20d)][_0x3eb941(0x218)]+_0x4bbf0c['userImage'],_0x3eb941(0x273)+_0x4bbf0c[_0x3eb941(0x25a)],_0x3eb941(0x1d7),_0x3eb941(0x2cc),![]);}),_0x4bbf0c['banned']&&await dbcon['query']('INSERT\x20INTO\x20bannedusers\x20(userid)\x20VALUES\x20(\x22'+_0x4bbf0c[_0x4b6492(0x25a)]+'\x22)',async(_0x3e98a6,_0xea1492)=>{if(_0x3e98a6)throw _0x3e98a6;});});});}),await _0x20abf5[_0x22a8d2(0x299)](_0x22a8d2(0x1ab),async(_0x37a268,_0x43bbe5)=>{const _0x3d293c=_0x22a8d2;if(_0x37a268)throw _0x37a268;await _0x43bbe5[_0x3d293c(0x32a)](async function(_0x2794a0){const _0x15e75a=_0x3d293c;let _0x4e1644=await utils[_0x15e75a(0x31c)](0xd),_0x3c99ec=await _0x37f19f[_0x15e75a(0x30d)](_0x411fd1=>_0x411fd1['faxstoreid']==_0x2794a0[_0x15e75a(0x2a9)]);await dbcon[_0x15e75a(0x299)]('INSERT\x20INTO\x20reviews\x20(uniqueid,\x20userid,\x20username,\x20rating,\x20itemname,\x20itemuniqueid,\x20content)\x20VALUES\x20(\x22'+_0x4e1644+_0x15e75a(0x237)+_0x2794a0[_0x15e75a(0x25a)]+_0x15e75a(0x237)+_0x2794a0[_0x15e75a(0x24d)]+_0x15e75a(0x237)+_0x2794a0[_0x15e75a(0x231)]+_0x15e75a(0x237)+_0x2794a0[_0x15e75a(0x20c)]+_0x15e75a(0x237)+_0x3c99ec+_0x15e75a(0x237)+_0x2794a0['comment']+'\x22)',async(_0x603ece,_0x44d8c7)=>{if(_0x603ece)throw _0x603ece;});});});let _0x534cf5=0x0;await _0x20abf5[_0x22a8d2(0x299)](_0x22a8d2(0x1e4),async(_0x5ab764,_0x557e21)=>{const _0x22b0ce=_0x22a8d2;if(_0x5ab764)throw _0x5ab764;await _0x557e21[_0x22b0ce(0x32a)](async function(_0x3a8e5c){const _0xadf6ad=_0x22b0ce;let _0x23cf38=await utils['generateRandom'](0x18),_0x194384=new Date(_0x3a8e5c[_0xadf6ad(0x2af)]),_0x4dd838=await JSON[_0xadf6ad(0x2c5)](_0x3a8e5c[_0xadf6ad(0x1b6)]);_0x534cf5=_0x534cf5+Number(_0x4dd838[_0xadf6ad(0x2bc)][_0xadf6ad(0x370)]);let _0xd6f4fd=await utils[_0xadf6ad(0x1a2)](JSON['stringify'](_0x4dd838[_0xadf6ad(0x365)]),!![]);await dbcon[_0xadf6ad(0x299)]('INSERT\x20INTO\x20receipts\x20(uniqueid,\x20buyerid,\x20payment,\x20datetime,\x20items)\x20VALUES\x20(\x22'+_0x23cf38+_0xadf6ad(0x237)+_0x3a8e5c[_0xadf6ad(0x25a)]+'\x22,\x20\x22'+_0x3a8e5c['method'][_0xadf6ad(0x2ea)](_0xadf6ad(0x222),'')+'\x22,\x20\x22'+_0x194384+_0xadf6ad(0x237)+_0xd6f4fd+'\x22)',async(_0x345f16,_0x156eeb)=>{if(_0x345f16)throw _0x345f16;});}),setTimeout(async()=>{const _0x3bb2aa=_0x22b0ce;dbcon[_0x3bb2aa(0x299)](_0x3bb2aa(0x2fa),async(_0x25f3ff,_0x380d32)=>{const _0xc9bbc2=_0x3bb2aa;if(_0x25f3ff)throw _0x25f3ff;let _0x505e9d=Number(_0x380d32[0x0][_0xc9bbc2(0x2cd)]);_0x505e9d=_0x505e9d+_0x534cf5,_0x505e9d=Math[_0xc9bbc2(0x1cd)](0x64*_0x505e9d)/0x64,_0x505e9d=_0x505e9d[_0xc9bbc2(0x371)](),!_0x505e9d[_0xc9bbc2(0x261)]('.')&&(_0x505e9d=_0x505e9d+_0xc9bbc2(0x2d9)),isNaN(_0x505e9d)&&(_0x505e9d=_0x380d32[0x0][_0xc9bbc2(0x2cd)]||_0xc9bbc2(0x347)),dbcon['query'](_0xc9bbc2(0x35a)+_0x505e9d+'\x22',async(_0x3c4860,_0x2e9dc6)=>{if(_0x3c4860)throw _0x3c4860;});});},0x1388);}),await _0x20abf5[_0x22a8d2(0x299)]('SELECT\x20*\x20FROM\x20promocodes',async(_0x3b070f,_0x3b30ad)=>{const _0x18e64f=_0x22a8d2;if(_0x3b070f)throw _0x3b070f;await _0x3b30ad[_0x18e64f(0x32a)](async function(_0x4fc543){const _0x4e6caf=_0x18e64f;let _0x2bd83a=await utils[_0x4e6caf(0x31c)](0xe);await dbcon['query'](_0x4e6caf(0x278)+_0x2bd83a+_0x4e6caf(0x237)+await utils['sanitize'](_0x4fc543[_0x4e6caf(0x1db)])+_0x4e6caf(0x36e)+(Number(_0x4fc543['discount'])||0x5)+')',async(_0xa1ab1c,_0x324cf5)=>{if(_0xa1ab1c)throw _0xa1ab1c;});});}),await _0x20abf5[_0x22a8d2(0x299)]('SELECT\x20*\x20FROM\x20generalPages',async(_0x54a6fa,_0x30fc26)=>{const _0x37febb=_0x22a8d2;if(_0x54a6fa)throw _0x54a6fa;await _0x30fc26[_0x37febb(0x32a)](async function(_0x2d6eee){const _0x4d48c9=_0x37febb;let _0x587c02=await utils[_0x4d48c9(0x31c)](0x10);await dbcon['query'](_0x4d48c9(0x24f)+_0x587c02+'\x22,\x20\x22'+await utils['sanitize'](_0x2d6eee[_0x4d48c9(0x279)])+'\x22,\x20\x22'+await utils['sanitize'](_0x2d6eee[_0x4d48c9(0x1a8)])+_0x4d48c9(0x237)+await utils['sanitize'](_0x2d6eee[_0x4d48c9(0x325)])+'\x22)',async(_0x1dbe6c,_0x2ed0a4)=>{if(_0x1dbe6c)throw _0x1dbe6c;});});}),await _0x20abf5[_0x22a8d2(0x299)](_0x22a8d2(0x30f)+_0x216010[_0x22a8d2(0x1fc)]['passport'][_0x22a8d2(0x341)]['id']+'\x22,\x20\x22Migrated\x20Store\x22,\x20\x22Has\x20migrated\x20to\x20Payment\x20System.\x22,\x20\x22'+Date[_0x22a8d2(0x2ed)]()+'\x22)',async(_0x391aa6,_0x289858)=>{if(_0x391aa6)throw _0x391aa6;}),await backend[_0x22a8d2(0x350)](_0x22a8d2(0x1ad),_0x22a8d2(0x338)+_0x216010[_0x22a8d2(0x1fc)][_0x22a8d2(0x324)][_0x22a8d2(0x341)]['username']+'\x20('+_0x216010[_0x22a8d2(0x1fc)][_0x22a8d2(0x324)]['user']['id']+_0x22a8d2(0x1c0));});}module[_0x4df485(0x33c)]={'init':init,'checkAuth':checkAuth,'resetAppLocals':resetAppLocals,'audit':audit,'randomIntFromInterval':randomIntFromInterval,'addCustomerRoleToUser':addCustomerRoleToUser,'logToDiscord':logToDiscord,'createNotification':createNotification,'createEmail':createEmail,'checkout':checkout,'checkoutInvoice':checkoutInvoice,'checkoutGiftcard':checkoutGiftcard,'completeCheckout':completeCheckout,'completeCheckoutInvoice':completeCheckoutInvoice,'completeCheckoutGiftcard':completeCheckoutGiftcard,'checkRoleRequirements':checkRoleRequirements,'faxstoreMigration':faxstoreMigration,'checkHasRole':checkHasRole};